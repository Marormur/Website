<!DOCTYPE html>
<html lang="de">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Marvin</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'media',
        };
    </script>
    <script>
        if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark');
        }
    </script>
</head>

<body class="m-0 bg-white text-gray-900 dark:bg-gray-900 dark:text-gray-100 transition-colors duration-300">
    <!-- Header -->
    <header
        class="w-full flex items-center gap-4 px-4 py-2 bg-gradient-to-br from-indigo-500 to-purple-600 text-white shadow">
        <!-- Profilicon -->
        <div class="relative" id="profile-container">
            <img src="./img/profil.jpg" alt="Profilbild von Marvin"
                class="w-10 h-10 object-cover rounded-full border-2 border-white cursor-pointer">
            <div id="profile-dropdown"
                class="hidden absolute left-0 mt-2 w-40 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 rounded shadow-lg">
                <a href="#" id="dropdown-about" class="block px-4 py-2 hover:bg-gray-200 dark:hover:bg-gray-700">√úber
                    mich</a>
                <a href="https://www.linkedin.com/in/marvin-temmen-788537216" rel="noopener" target="_blank"
                    class="block px-4 py-2 hover:bg-gray-200 dark:hover:bg-gray-700">LinkedIn</a>
            </div>
        </div>
        <!-- Men√ºpunkte -->
        <nav class="flex space-x-4 items-center relative">
            <span id="program-label" class="py-2 px-4 cursor-pointer">Sucher</span>
            <div id="program-dropdown"
                class="hidden absolute top-full left-0 mt-1 w-40 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 rounded shadow-lg">
                <a href="#" id="about-program" class="block px-4 py-2 hover:bg-gray-200 dark:hover:bg-gray-700">√úber
                    Sucher</a>

                <!-- <a href="#" class="block px-4 py-2 hover:bg-gray-200 dark:hover:bg-gray-700">Finder</a>
                <a href="#" class="block px-4 py-2 hover:bg-gray-200 dark:hover:bg-gray-700">Einstellungen</a>
                <a href="#" class="block px-4 py-2 hover:bg-gray-200 dark:hover:bg-gray-700">Abmelden</a> -->
            </div>
        </nav>
    </header>
    <div class="max-w-4xl mx-auto">
        <div id="tab-content" class="p-4">
            <div id="start" class="tab-content">
                <!-- Desktop Items -->
                <div id="desktop-icons" class="fixed right-0 top-10 mt-4 flex flex-col gap-4 p-4">
                    <div class="flex flex-col items-center cursor-pointer" onclick="showTab('projects')">
                        <span class="text-5xl">üìÅ</span>
                        <span class="mt-2 text-lg font-semibold">Projekte</span>
                    </div>
                    <!-- <div class="flex flex-col items-center cursor-pointer" onclick="showTab('contact')">
                        <span class="text-5xl">üìû</span>
                        <span class="mt-2 text-lg font-semibold">Kontakt</span>
                    </div> -->
                </div>
            </div>
        </div>
    </div>
    <!-- Projekte -->
    <div id="projects-modal" class="fixed inset-0 flex items-center justify-center hidden modal">
        <div class="bg-white dark:bg-gray-800 rounded-lg overflow-hidden shadow-lg w-full max-w-xl autopointer">
            <div class="flex items-center px-4 py-2 bg-gray-200 dark:bg-gray-700 rounded-t-lg draggable-header">
                <div class="flex space-x-2">
                    <button title="Schlie√üen" id="close-projects-modal"
                        class="ml-auto text-2xl leading-none text-gray-700 dark:text-gray-300">
                        <div class="w-3 h-3 bg-red-500 rounded-full"></div>
                    </button>
                    <div class="w-3 h-3 bg-yellow-500 rounded-full"></div>
                    <div class="w-3 h-3 bg-green-500 rounded-full"></div>
                </div>
                <h2 class="ml-4 font-semibold text-gray-700 dark:text-gray-300">Projekte</h2>
            </div>
            <div class="p-4">
                <ul id="repo-list" class="grid grid-cols-1 md:grid-cols-2 gap-4"></ul>
                <!-- Github Repos laden-->
                <script>
                    const username = "Marormur";
                    const cacheKey = `githubRepos_${username}`;
                    const cacheTimestampKey = `githubReposTimestamp_${username}`;
                    const cacheDuration = 1000 * 60 * 60; // 1 Stunde in Millisekunden

                    // Funktion zur Darstellung der Repos aus den Daten:
                    function loadRepos(repos) {
                        const list = document.getElementById("repo-list");
                        // Leere die Liste vor dem Auff√ºllen
                        list.innerHTML = "";
                        if (Array.isArray(repos)) {
                            repos.forEach(repo => {
                                const item = document.createElement("li");
                                item.innerHTML = `
                                          <div class="bg-white dark:bg-gray-800 p-4 rounded-lg shadow hover:shadow-md transition">
                                            <h3 class="text-xl font-semibold mb-2">
                                              <a href="${repo.html_url}" target="_blank" class="text-blue-600 hover:underline">${repo.name}</a>
                                            </h3>
                                            <p>${repo.description || "Keine Beschreibung"}</p>
                                          </div>
                                        `;
                                list.appendChild(item);
                            });
                        } else {
                            console.error("Unerwartetes API-Response-Format:", repos);
                        }
                    }

                    // Funktion, um Repos aus der API zu holen und zu cachen:
                    function fetchRepos() {
                        fetch(`https://api.github.com/users/${username}/repos`)
                            .then(res => res.json())
                            .then(repos => {
                                // Speichere die Daten und den Zeitstempel in localStorage.
                                localStorage.setItem(cacheKey, JSON.stringify(repos));
                                localStorage.setItem(cacheTimestampKey, Date.now().toString());
                                loadRepos(repos);
                            })
                            .catch(err => {
                                console.error("Fehler beim Laden der Repos:", err);
                            });
                    }

                    document.addEventListener("DOMContentLoaded", function () {
                        const cachedRepos = localStorage.getItem(cacheKey);
                        const cachedTimestamp = localStorage.getItem(cacheTimestampKey);
                        if (cachedRepos && cachedTimestamp) {
                            const age = Date.now() - parseInt(cachedTimestamp, 10);
                            if (age < cacheDuration) {
                                // Nutze den Cache, wenn er nicht √§lter als eine Stunde ist.
                                const repos = JSON.parse(cachedRepos);
                                loadRepos(repos);
                                return;
                            }
                        }
                        // Andernfalls neu laden.
                        fetchRepos();
                    });
                </script>

            </div>
        </div>

    </div>
    <!-- √úber mich -->
    <div id="about-modal" class="fixed inset-0 flex items-center justify-center hidden modal">
        <div class="bg-white dark:bg-gray-800 rounded-lg overflow-hidden shadow-lg w-auto max-w-xl autopointer">
            <div class="flex items-center px-4 py-2 bg-gray-200 dark:bg-gray-700 rounded-t-lg draggable-header">
                <div class="flex space-x-2">
                    <button title="Schlie√üen" id="close-about-modal"
                        class="ml-auto text-2xl leading-none text-gray-700 dark:text-gray-300">
                        <div class="w-3 h-3 bg-red-500 rounded-full"></div>
                    </button>
                    <div class="w-3 h-3 bg-yellow-500 rounded-full"></div>
                    <div class="w-3 h-3 bg-green-500 rounded-full"></div>
                </div>
                <h2 class="ml-4 font-semibold text-gray-700 dark:text-gray-300">√úber mich</h2>
            </div>
            <!-- Mittelteil mit Bild, Titel, Infos -->
            <div class="flex flex-col items-center text-gray-700 dark:text-gray-200 mt-8">
                <!-- Titelbild -->
                <img src="./img/profil.jpg" alt="Bild" class="w-24 h-24 object-contain mb-4 ">

                <!-- √úberschrift -->
                <h2 class="text-xl font-semibold">Marvin Temmen</h2>
                <p class="text-sm">M√§rz 1999</p>

                <!-- Auflistung zentraler Infos -->
                <div class="mt-4 space-y-1 text-sm">
                    <p><strong>Name:</strong> Marvin T.</p>
                    <p><strong>Wohnort:</strong> Deutschland</p>
                    <!-- <p><strong>Hobbys:</strong> Computer, Schach, u.v.m.</p> -->
                    <p><strong>Beruf:</strong> .NET-Entwickler</p>
                </div>

                <!-- Mehr-Infos-Button -->
                <button class="mt-4 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded">
                    Mehr Infos ‚Ä¶
                </button>

                <!-- Fu√üzeile -->
                <div
                    class="mt-6 text-xs text-center text-gray-500 dark:text-gray-400 border-t border-gray-300 dark:border-gray-700 pt-2">
                    ¬© 2025 Marvin T. ‚Äî Alle Rechte vorbehalten.
                </div>
            </div>
        </div>
    </div>
    <!-- Drag & Drop Script -->
    <script>
        function makeDraggable(modalId) {
            const modal = document.getElementById(modalId);
            const header = modal.querySelector('.draggable-header');
            if (!header) return;

            header.style.cursor = 'move';
            let offsetX = 0, offsetY = 0;

            header.addEventListener('mousedown', function (e) {
                // Berechne die Differenz zwischen Mausposition und Elementposition.
                offsetX = e.clientX - modal.getBoundingClientRect().left;
                offsetY = e.clientY - modal.getBoundingClientRect().top;
                // Stelle die Positionierung auf absolut, damit das Element frei bewegbar ist.
                modal.style.position = 'absolute';

                function mouseMoveHandler(e) {
                    modal.style.left = (e.clientX - offsetX) + 'px';
                    modal.style.top = (e.clientY - offsetY) + 'px';
                }

                function mouseUpHandler(e) {
                    document.removeEventListener('mousemove', mouseMoveHandler);
                    document.removeEventListener('mouseup', mouseUpHandler);
                }

                document.addEventListener('mousemove', mouseMoveHandler);
                document.addEventListener('mouseup', mouseUpHandler);
                e.preventDefault();
            });
        }
        document.addEventListener("DOMContentLoaded", function () {
            makeDraggable("projects-modal");
            makeDraggable("about-modal");
        });
    </script>
    <!-- Fenster wechseln -->
    <script>
        // Wir starten mit einer hohen z-Index-Zahl.
        let topZIndex = 1000;

        // Diese Funktion erh√∂ht den z-Index des angegebenen Modals und bringt es in den Vordergrund.
        function bringToFront(modalId) {
            topZIndex++;
            document.getElementById(modalId).style.zIndex = topZIndex;
        }

        document.addEventListener("DOMContentLoaded", function () {
            // F√ºge einen Klick-Listener zum inneren Container (Dialog) des Projekte-Modals hinzu.
            const projectsDialog = document.querySelector("#projects-modal > div");
            if (projectsDialog) {
                projectsDialog.addEventListener("click", function (e) {
                    bringToFront("projects-modal");
                    updateProgramLabel("Sucher");
                });
            }

            // F√ºge einen Klick-Listener zum inneren Container (Dialog) des √úber-mich-Modals hinzu.
            const aboutDialog = document.querySelector("#about-modal > div");
            if (aboutDialog) {
                aboutDialog.addEventListener("click", function (e) {
                    bringToFront("about-modal");
                    updateProgramLabel("√úber mich");
                });
            }
        });
    </script>
    <!-- Dock -->
    <div id="dock"
        class="fixed bottom-0 left-0 right-0 flex justify-center bg-white bg-opacity-20 backdrop-blur-md text-white p-4">
        <div class="flex flex-col items-center cursor-pointer mx-2" onclick="showTab('projects')">
            <img src="./img/sucher.png" alt="Sucher Icon" class="w-10 h-10">
        </div>
    </div>
    <!-- Neuer zentraler Handler f√ºr den Program-Men√ºtext einf√ºgen -->
    <script>
        // Neue Funktion zum zentralen Aktualisieren des Program-Men√ºtexts.
        function updateProgramLabel(newLabel) {
            const programLabel = document.getElementById("program-label");
            if (programLabel) {
                programLabel.innerText = newLabel;
            }
        }
    </script>

    <!-- Aktualisiere die showTab-Funktion -->
    <script>
        function showTab(tabName) {
            if (tabName === "projects") {
                document.getElementById("projects-modal").classList.remove("hidden");
                // Update program label via Handler.
                updateProgramLabel("Sucher");
                return;
            }
            const targetButton = document.querySelector(`.tab-button[data-tab="${tabName}"]`);
            if (targetButton) {
                targetButton.click();
                // F√ºr andere Tabs, passe das Label an:
                if (tabName === "about") {
                    updateProgramLabel("√úber mich");
                } else {
                    updateProgramLabel("Start");
                }
            }
        }
    </script>

    <!-- Aktualisiere den zentralen Event-Handler -->
    <script>
        function initEventHandlers() {
            // Elemente definieren
            const profileContainer = document.getElementById('profile-container');
            const profileDropdown = document.getElementById('profile-dropdown');
            const programDropdown = document.getElementById('program-dropdown');
            const programLabel = document.getElementById('program-label');
            const dropdownAbout = document.getElementById('dropdown-about');
            const closeProjectsButton = document.getElementById("close-projects-modal");
            const closeAboutButton = document.getElementById("close-about-modal");

            // Profil-Dropdown: Klick auf Profilcontainer schaltet es um und schlie√üt das Programm-Dropdown.
            profileContainer.addEventListener('click', function (event) {
                // Schlie√üe Programmdropdown
                if (programDropdown) {
                    programDropdown.classList.add('hidden');
                }
                // Toggle Profil-Dropdown
                if (profileDropdown) {
                    profileDropdown.classList.toggle('hidden');
                }
                event.stopPropagation();
            });

            // Programmlabel: Klick schaltet das Programm-Dropdown um und schlie√üt das Profil-Dropdown.
            programLabel.addEventListener('click', function (event) {
                // Schlie√üe Profil-Dropdown
                if (profileDropdown) {
                    profileDropdown.classList.add('hidden');
                }
                // Toggle Programmdropdown
                if (programDropdown) {
                    programDropdown.classList.toggle('hidden');
                }
                event.stopPropagation();
            });

            // Klick au√üerhalb schlie√üt beide Dropdowns.
            document.addEventListener('click', function (event) {
                if (profileDropdown) profileDropdown.classList.add('hidden');
                if (programDropdown) programDropdown.classList.add('hidden');
            });

            // Dropdown "√úber mich" im Profil-Dropdown:
            if (dropdownAbout) {
                dropdownAbout.addEventListener('click', function (event) {
                    event.preventDefault();
                    event.stopPropagation();
                    if (profileDropdown) profileDropdown.classList.add('hidden');
                    document.getElementById('about-modal').classList.remove('hidden');
                    updateProgramLabel("√úber mich");
                });
            }

            // Modal-Schlie√üen: Projekte
            if (closeProjectsButton) {
                closeProjectsButton.addEventListener("click", function () {
                    document.getElementById("projects-modal").classList.add("hidden");
                    updateProgramLabel("Sucher");
                });
            }
            // Modal-Schlie√üen: √úber mich
            if (closeAboutButton) {
                closeAboutButton.addEventListener("click", function () {
                    document.getElementById("about-modal").classList.add("hidden");
                    updateProgramLabel("Sucher");
                });
            }
        }

        document.addEventListener('DOMContentLoaded', initEventHandlers);
    </script>
</body>

</html>