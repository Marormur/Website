<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <title>JSDoc: Source: theme.js</title>

        <script src="scripts/prettify/prettify.js"></script>
        <script src="scripts/prettify/lang-css.js"></script>
        <!--[if lt IE 9]>
            <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
        <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css" />
        <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css" />
    </head>

    <body>
        <div id="main">
            <h1 class="page-title">Source: theme.js</h1>

            <section>
                <article>
                    <pre class="prettyprint source linenums"><code>/**
 * theme.js
 * Theme-Management (Dark/Light Mode) für den macOS Desktop-Klon
 */

// ============================================================================
// Theme-System
// ============================================================================

const systemDarkQuery = window.matchMedia('(prefers-color-scheme: dark)');
const validThemePreferences = window.APP_CONSTANTS?.VALID_THEME_PREFERENCES || [
    'system',
    'light',
    'dark',
];

let themePreference = localStorage.getItem(
    window.APP_CONSTANTS?.THEME_PREFERENCE_KEY || 'themePreference',
);
if (!validThemePreferences.includes(themePreference)) {
    themePreference = 'system';
}

/**
 * Aktualisiert das Theme basierend auf der aktuellen Präferenz
 */
function updateThemeFromPreference() {
    const useDark =
        themePreference === 'dark' ||
        (themePreference === 'system' &amp;&amp; systemDarkQuery.matches);
    document.documentElement.classList.toggle('dark', useDark);
}

/**
 * Setzt die Theme-Präferenz
 * @param {string} pref - 'system' | 'light' | 'dark'
 */
function setThemePreference(pref) {
    if (!validThemePreferences.includes(pref)) return;

    themePreference = pref;
    localStorage.setItem(
        window.APP_CONSTANTS?.THEME_PREFERENCE_KEY || 'themePreference',
        pref,
    );
    updateThemeFromPreference();

    // Dispatch Event für andere Module
    window.dispatchEvent(
        new CustomEvent('themePreferenceChange', {
            detail: { preference: pref },
        }),
    );
}

/**
 * Gibt die aktuelle Theme-Präferenz zurück
 * @returns {string} 'system' | 'light' | 'dark'
 */
function getThemePreference() {
    return themePreference;
}

// Initiales Theme setzen
updateThemeFromPreference();

// System-Theme-Änderungen beobachten
const handleSystemThemeChange = () => {
    updateThemeFromPreference();
};

if (typeof systemDarkQuery.addEventListener === 'function') {
    systemDarkQuery.addEventListener('change', handleSystemThemeChange);
} else if (typeof systemDarkQuery.addListener === 'function') {
    systemDarkQuery.addListener(handleSystemThemeChange);
}

// ============================================================================
// Global Export
// ============================================================================
if (typeof window !== 'undefined') {
    window.ThemeSystem = {
        setThemePreference,
        getThemePreference,
        updateThemeFromPreference,
    };

    // Abwärtskompatibilität
    window.setThemePreference = setThemePreference;
    window.getThemePreference = getThemePreference;
}
</code></pre>
                </article>
            </section>
        </div>

        <nav>
            <h2><a href="index.html">Home</a></h2>
            <h3>Modules</h3>
            <ul>
                <li><a href="module-InstanceManager.html">InstanceManager</a></li>
            </ul>
            <h3>Classes</h3>
            <ul>
                <li><a href="BaseWindowInstance.html">BaseWindowInstance</a></li>
                <li><a href="KeyboardShortcutManager.html">KeyboardShortcutManager</a></li>
                <li><a href="MultiInstanceIntegration.html">MultiInstanceIntegration</a></li>
                <li><a href="SessionManager.html">SessionManager</a></li>
                <li><a href="TerminalInstance.html">TerminalInstance</a></li>
                <li><a href="TextEditorInstance.html">TextEditorInstance</a></li>
                <li><a href="WindowTabManager.html">WindowTabManager</a></li>
                <li><a href="module-InstanceManager-InstanceManager.html">InstanceManager</a></li>
            </ul>
            <h3>Global</h3>
            <ul>
                <li><a href="global.html#ensureSvgNamespace">ensureSvgNamespace</a></li>
                <li><a href="global.html#getDockReservedBottom">getDockReservedBottom</a></li>
                <li><a href="global.html#getMenuIconSvg">getMenuIconSvg</a></li>
                <li><a href="global.html#getThemePreference">getThemePreference</a></li>
                <li><a href="global.html#initDockMagnification">initDockMagnification</a></li>
                <li><a href="global.html#renderIconIntoElement">renderIconIntoElement</a></li>
                <li><a href="global.html#setThemePreference">setThemePreference</a></li>
                <li>
                    <a href="global.html#updateThemeFromPreference">updateThemeFromPreference</a>
                </li>
            </ul>
        </nav>

        <br class="clear" />

        <footer>
            Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.5</a> on
            Sat Oct 25 2025 16:35:41 GMT+0200 (Central European Summer Time)
        </footer>

        <script>
            prettyPrint();
        </script>
        <script src="scripts/linenumber.js"></script>
    </body>
</html>
