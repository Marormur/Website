{"version":3,"file":"finder-instance.js","sourceRoot":"","sources":["../src/ts/finder-instance.ts"],"names":[],"mappings":";AAAA;;;;GAIG;;AAWH,MAAM,gBAAgB,GAAG,UAAU,CAAC;AAyBpC,MAAM,cAAe,SAAQ,CAAC,MAAM,CAAC,kBAAkB,IAAI;CAAQ,CAAC;IAwChE,YAAY,MAAW;QACnB,KAAK,CAAC,EAAE,GAAG,MAAM,EAAE,IAAI,EAAE,QAAQ,EAAE,CAAC,CAAC;QAxCzC,gBAAW,GAAa,EAAE,CAAC;QAC3B,gBAAW,GAAa,UAAU,CAAC;QACnC,kBAAa,GAAgB,IAAI,GAAG,EAAE,CAAC;QACvC,aAAQ,GAAa,MAAM,CAAC;QAC5B,WAAM,GAAsC,MAAM,CAAC;QACnD,cAAS,GAAmB,KAAK,CAAC;QAClC,gBAAW,GAAU,EAAE,CAAC;QACxB,kBAAa,GAAG,KAAK,CAAC;QACtB,gBAAW,GAAG,KAAK,CAAC;QACpB,uBAAkB,GAAG,EAAE,CAAC;QACxB,uBAAkB,GAAqB,IAAI,GAAG,EAAE,CAAC;QACjD,cAAS,GAAgB,IAAI,GAAG,EAAE,CAAC;QACnC,gBAAW,GAA2E,EAAE,CAAC;QACzF,uBAAkB,GAAkB,IAAI,CAAC;QACzC,mBAAc,GAAe,EAAE,CAAC;QAChC,YAAO,GASH;YACA,eAAe,EAAE,IAAI;YACrB,aAAa,EAAE,IAAI;YACnB,gBAAgB,EAAE,IAAI;YACtB,aAAa,EAAE,IAAI;YACnB,WAAW,EAAE,IAAI;YACjB,WAAW,EAAE,IAAI;YACjB,OAAO,EAAE,IAAI;YACb,WAAW,EAAE,IAAI;SACpB,CAAC;QAEF,uBAAkB,GAAuB,IAAI,GAAG,EAAE,CAAC;QACnD,sBAAiB,GAAwB,EAAE,CAAC;QAKxC,IAAI,CAAC,aAAa,GAAG,IAAI,GAAG,EAAE,CAAC;QAC/B,IAAI,CAAC,kBAAkB,GAAG,IAAI,CAAC;QAC/B,IAAI,CAAC,cAAc,GAAG,EAAE,CAAC;QACzB,IAAI,CAAC,kBAAkB,GAAG,IAAI,GAAG,EAAE,CAAC;QACpC,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC,wBAAwB,EAAE,CAAC;IAC7D,CAAC;IAEO,wBAAwB;QAC5B,MAAM,UAAU,GAAG;YACf,IAAI,EAAE,QAAQ;YACd,IAAI,EAAE,IAAI;YACV,QAAQ,EAAE;gBACN,SAAS,EAAE;oBACP,IAAI,EAAE,QAAQ;oBACd,IAAI,EAAE,IAAI;oBACV,QAAQ,EAAE;wBACN,WAAW,EAAE;4BACT,IAAI,EAAE,MAAM;4BACZ,IAAI,EAAE,IAAI;4BACV,OAAO,EACH,gEAAgE;4BACpE,IAAI,EAAE,IAAI;yBACb;qBACJ;iBACJ;gBACD,SAAS,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,IAAI,EAAE,QAAQ,EAAE,EAAE,EAAE;gBACvD,QAAQ,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,KAAK,EAAE,QAAQ,EAAE,EAAE,EAAE;gBACvD,KAAK,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,IAAI,EAAE,QAAQ,EAAE,EAAE,EAAE;gBACnD,MAAM,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,IAAI,EAAE,QAAQ,EAAE,EAAE,EAAE;aACvD;SACJ,CAAC;QACF,OAAO,EAAE,CAAC,gBAAgB,CAAC,EAAE,UAAU,EAAE,CAAC;IAC9C,CAAC;IAES,gBAAgB,CAAC,YAAkC;QACzD,OAAO;YACH,WAAW,EAAE,YAAY,CAAC,WAAW,IAAI,EAAE;YAC3C,WAAW,EAAG,YAAY,CAAC,WAAwB,IAAI,UAAU;YACjE,QAAQ,EAAG,YAAY,CAAC,QAAqB,IAAI,MAAM;YACvD,MAAM,EAAG,YAAY,CAAC,MAAgC,IAAI,MAAM;YAChE,SAAS,EAAG,YAAY,CAAC,SAAsC,IAAI,KAAK;YACxE,SAAS,EAAE,YAAY,CAAC,SAAS,IAAI,EAAE;YACvC,WAAW,EAAE,YAAY,CAAC,WAAW,IAAI,EAAE;SAC/B,CAAC;IACrB,CAAC;IAED,MAAM;QACF,IAAI,CAAC,IAAI,CAAC,SAAS;YAAE,OAAO;QAC5B,MAAM,IAAI,GAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;mBA+CF,CAAC;QAEZ,IAAI,CAAC,SAAS,CAAC,SAAS,GAAG,IAAI,CAAC;QAEhC,IAAI,CAAC,OAAO,CAAC,eAAe,GAAG,IAAI,CAAC,SAAS,CAAC,aAAa,CACvD,gCAAgC,CACnC,CAAC;QACF,IAAI,CAAC,OAAO,CAAC,aAAa,GAAG,IAAI,CAAC,SAAS,CAAC,aAAa,CAAC,8BAA8B,CAAC,CAAC;QAC1F,IAAI,CAAC,OAAO,CAAC,gBAAgB,GAAG,IAAI,CAAC,SAAS,CAAC,aAAa,CACxD,iCAAiC,CACpC,CAAC;QACF,IAAI,CAAC,OAAO,CAAC,aAAa,GAAG,IAAI,CAAC,SAAS,CAAC,aAAa,CAAC,8BAA8B,CAAC,CAAC;QAC1F,IAAI,CAAC,OAAO,CAAC,WAAW,GAAG,IAAI,CAAC,SAAS,CAAC,aAAa,CAAC,2BAA2B,CAAC,CAAC;QACrF,IAAI,CAAC,OAAO,CAAC,WAAW,GAAG,IAAI,CAAC,SAAS,CAAC,aAAa,CAAC,uBAAuB,CAAC,CAAC;QACjF,IAAI,CAAC,OAAO,CAAC,OAAO,GAAG,IAAI,CAAC,SAAS,CAAC,aAAa,CAAC,uBAAuB,CAAC,CAAC;QAC7E,IAAI,CAAC,OAAO,CAAC,WAAW,GAAG,IAAI,CAAC,SAAS,CAAC,aAAa,CAAC,sBAAsB,CAAC,CAAC;QAEhF,IAAI,CAAC;YACD,IAAI,MAAM,CAAC,OAAO,IAAI,OAAO,MAAM,CAAC,OAAO,CAAC,iBAAiB,KAAK,UAAU,EAAE,CAAC;gBAC3E,MAAM,CAAC,OAAO,CAAC,iBAAiB,EAAE,CAAC;YACvC,CAAC;QACL,CAAC;QAAC,MAAM,CAAC;YACL,UAAU;QACd,CAAC;IACL,CAAC;IAED,oBAAoB;QAChB,IAAI,CAAC,IAAI,CAAC,SAAS;YAAE,OAAO;QAC5B,IAAI,CAAC,SAAS,CAAC,gBAAgB,CAAC,OAAO,EAAE,CAAC,CAAQ,EAAE,EAAE,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,CAAC;QAC7E,IAAI,CAAC,SAAS,CAAC,gBAAgB,CAAC,UAAU,EAAE,CAAC,CAAQ,EAAE,EAAE,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAC,CAAC,CAAC,CAAC;QACtF,IAAI,CAAE,IAAY,CAAC,kBAAkB,EAAE,CAAC;YACpC,IAAI,CAAC,UAAU,CACV,IAAY,CAAC,KAAK,EAAE,WAAW,IAAI,EAAE,EACrC,IAAY,CAAC,KAAK,EAAE,WAAW,IAAI,IAAI,CAAC,WAAW,CACvD,CAAC;QACN,CAAC;IACL,CAAC;IAEO,YAAY,CAAC,CAAM;QACvB,MAAM,WAAW,GAAuB,IAAI,CAAC,OAAO,EAAE,WAAW,IAAI,IAAI,CAAC,SAAS,CAAC;QACpF,IAAI,WAAW,IAAI,WAAW,CAAC,QAAQ,CAAC,CAAC,CAAC,MAAM,CAAC,EAAE,CAAC;YAChD,MAAM,MAAM,GACR,CAAC,CAAC,MAAM,CAAC,OAAO,EAAE,CAAC,sCAAsC,CAAC,IAAI,IAAI,CAAC;YACvE,MAAM,aAAa,GAAI,CAAC,CAAC,MAAsB,CAAC,EAAE,KAAK,qBAAqB,CAAC;YAC7E,MAAM,gBAAgB,GAAI,CAAC,CAAC,MAAsB,CAAC,EAAE,KAAK,uBAAuB,CAAC;YAClF,IAAI,CAAC,MAAM,IAAI,aAAa,IAAI,gBAAgB,EAAE,CAAC;gBAC/C,IAAI,IAAI,CAAC,aAAa,CAAC,IAAI,EAAE,CAAC;oBAC1B,IAAI,CAAC,aAAa,CAAC,KAAK,EAAE,CAAC;oBAC3B,IAAI,CAAC,kBAAkB,GAAG,IAAI,CAAC;oBAC/B,2DAA2D;oBAC3D,IAAI,CAAC;wBACD,MAAM,IAAI,GAAG,WAAW,CAAC,gBAAgB,CAAC,mBAAmB,CAAC,CAAC;wBAC/D,IAAI,CAAC,OAAO,CAAC,CAAC,CAAU,EAAE,EAAE;4BACvB,CAAiB,CAAC,SAAS,CAAC,MAAM,CAAC,aAAa,EAAE,kBAAkB,CAAC,CAAC;wBAC3E,CAAC,CAAC,CAAC;oBACP,CAAC;oBAAC,MAAM,CAAC,CAAA,CAAC;oBACV,IAAI,CAAC,aAAa,EAAE,CAAC;gBACzB,CAAC;gBACD,oFAAoF;gBACpF,IAAI,CAAC,MAAM,IAAI,aAAa,IAAI,gBAAgB,EAAE,CAAC;oBAC/C,CAAC,CAAC,eAAe,EAAE,EAAE,CAAC;oBACtB,CAAC,CAAC,cAAc,EAAE,EAAE,CAAC;oBACrB,OAAO;gBACX,CAAC;YACL,CAAC;QACL,CAAC;QAED,MAAM,WAAW,GACb,CAAC,CAAC,MAAM,CAAC,OAAO,EAAE,CAAC,sCAAsC,CAAC,IAAI,IAAI,CAAC;QACvE,IAAI,WAAW,IAAK,WAAmB,CAAC,OAAO,EAAE,CAAC;YAC9C,MAAM,IAAI,GAAI,WAAmB,CAAC,OAAO,CAAC,QAAkB,CAAC;YAC7D,MAAM,IAAI,GAAI,WAAmB,CAAC,OAAO,CAAC,QAAkB,CAAC;YAC7D,MAAM,MAAM,GAAI,WAAmB,CAAC,OAAO,CAAC,KAAe,CAAC;YAC5D,MAAM,KAAK,GAAG,OAAO,MAAM,KAAK,QAAQ,CAAC,CAAC,CAAC,QAAQ,CAAC,MAAM,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC;YACtE,IAAI,IAAI,IAAI,IAAI,EAAE,CAAC;gBACf,IAAI,CAAC,oBAAoB,CAAC,EAAE,IAAI,EAAE,IAAI,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC,EAAE,CAAC,CAAC;gBAC3D,CAAC,CAAC,eAAe,EAAE,EAAE,CAAC;gBACtB,CAAC,CAAC,cAAc,EAAE,EAAE,CAAC;gBACrB,OAAO;YACX,CAAC;QACL,CAAC;QAED,MAAM,MAAM,GAAG,CAAC,CAAC,MAAM,CAAC,OAAO,EAAE,CAAC,eAAe,CAAC,EAAE,OAAO,CAAC,MAA4B,CAAC;QACzF,IAAI,CAAC,MAAM;YAAE,OAAO;QAEpB,MAAM,QAAQ,GAA+B;YACzC,mBAAmB,EAAE,GAAG,EAAE;gBACtB,MAAM,IAAI,GAAG,CAAC,CAAC,MAAM,CAAC,OAAO,CAAC,oBAAoB,CAAC,EAAE,OAAO,CAAC,UAAsB,CAAC;gBACpF,IAAI,IAAI;oBAAE,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;YACpC,CAAC;YACD,mBAAmB,EAAE,GAAG,EAAE,CAAC,IAAI,CAAC,UAAU,EAAE;YAC5C,eAAe,EAAE,GAAG,EAAE,CAAC,IAAI,CAAC,UAAU,CAAC,EAAE,EAAE,IAAI,CAAC,WAAW,CAAC;YAC5D,uBAAuB,EAAE,GAAG,EAAE;gBAC1B,MAAM,IAAI,GAAG,CAAC,CAAC,MAAM,CAAC,OAAO,CAAC,aAAa,CAAC,EAAE,OAAO,CAAC,IAAc,CAAC;gBACrE,IAAI,IAAI,KAAK,SAAS;oBAAE,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;YAClD,CAAC;YACD,kBAAkB,EAAE,GAAG,EAAE;gBACrB,MAAM,MAAM,GAAG,CAAC,CAAC,MAAM,CAAC,OAAO,CAAC,gBAAgB,CAAC,EAAE,OAAO;qBACrD,MAA+B,CAAC;gBACrC,IAAI,MAAM;oBAAE,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;YACvC,CAAC;YACD,oBAAoB,EAAE,GAAG,EAAE;gBACvB,MAAM,IAAI,GAAG,CAAC,CAAC,MAAM,CAAC,OAAO,CAAC,kBAAkB,CAAC,EAAE,OAAO,CAAC,QAAoB,CAAC;gBAChF,IAAI,IAAI;oBAAE,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;YACrC,CAAC;SACJ,CAAC;QAEF,IAAI,QAAQ,CAAC,MAAM,CAAC;YAAE,QAAQ,CAAC,MAAM,CAAC,EAAE,CAAC;IAC7C,CAAC;IAEO,kBAAkB,CAAC,CAAM;QAC7B,MAAM,IAAI,GAAG,CAAC,CAAC,MAAM,CAAC,OAAO,EAAE,CAAC,wBAAwB,CAAC,CAAC;QAC1D,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,OAAO,CAAC,cAAc,KAAK,iBAAiB;YAAE,OAAO;QACvE,MAAM,IAAI,GAAG,IAAI,CAAC,OAAO,CAAC,QAAkB,CAAC;QAC7C,MAAM,IAAI,GAAG,IAAI,CAAC,OAAO,CAAC,QAAkB,CAAC;QAC7C,IAAI,IAAI,IAAI,IAAI;YAAE,IAAI,CAAC,QAAQ,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;IAChD,CAAC;IAEO,oBAAoB,CAAC,EACzB,IAAI,EACJ,IAAI,EAAE,KAAK,EACX,KAAK,EACL,KAAK,GAMR;QACG,MAAM,OAAO,GAAG,CAAC,CAAC,KAAK,CAAC,QAAQ,CAAC;QACjC,MAAM,QAAQ,GAAG,CAAC,CAAC,CAAC,KAAK,CAAC,OAAO,IAAI,KAAK,CAAC,OAAO,CAAC,CAAC;QACpD,MAAM,KAAK,GAAG,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,cAAc,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC;QAElF,IAAI,OAAO,IAAI,KAAK,GAAG,CAAC,IAAI,IAAI,CAAC,kBAAkB,KAAK,IAAI,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,KAAK,CAAC,EAAE,CAAC;YACnF,MAAM,KAAK,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,kBAAkB,EAAE,KAAK,CAAC,CAAC,CAAC;YACpE,MAAM,GAAG,GAAG,IAAI,CAAC,GAAG,CAAC,KAAK,GAAG,CAAC,EAAE,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,kBAAkB,EAAE,KAAK,CAAC,CAAC,CAAC;YAC1E,IAAI,CAAC,QAAQ;gBAAE,IAAI,CAAC,aAAa,CAAC,KAAK,EAAE,CAAC;YAC1C,KAAK,IAAI,CAAC,GAAG,KAAK,EAAE,CAAC,IAAI,GAAG,EAAE,CAAC,EAAE,EAAE,CAAC;gBAChC,MAAM,EAAE,GAAG,IAAI,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC;gBAClC,IAAI,EAAE,IAAI,EAAE,CAAC,IAAI;oBAAE,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,EAAE,CAAC,IAAI,CAAC,CAAC;YACvD,CAAC;QACL,CAAC;aAAM,IAAI,QAAQ,EAAE,CAAC;YAClB,IAAI,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,IAAI,CAAC;gBAAE,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;;gBAC7D,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;YAClC,IAAI,CAAC,kBAAkB,GAAG,MAAM,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,KAAK,CAAC;QACjE,CAAC;aAAM,CAAC;YACJ,IAAI,CAAC,aAAa,CAAC,KAAK,EAAE,CAAC;YAC3B,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;YAC7B,IAAI,CAAC,kBAAkB,GAAG,MAAM,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,KAAK,CAAC;QACjE,CAAC;QACD,IAAI,CAAC,aAAa,EAAE,CAAC;IACzB,CAAC;IAED,oBAAoB;QAChB,MAAM,KAAK,GAAG,CACV,MAAM,CAAC,OAAO,EAAE,iBAAiB,EAAE,EAAE;YACrC,QAAQ,CAAC,eAAe,EAAE,IAAI;YAC9B,IAAI,CACP,CAAC,WAAW,EAAE,CAAC;QAChB,MAAM,KAAK,GAAG,KAAK,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;QACrC,IAAI,IAAI,CAAC,WAAW,CAAC,MAAM,KAAK,CAAC,EAAE,CAAC;YAChC,QAAQ,IAAI,CAAC,WAAW,EAAE,CAAC;gBACvB,KAAK,UAAU;oBACX,OAAO,KAAK,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,UAAU,CAAC;gBAC3C,KAAK,QAAQ;oBACT,OAAO,KAAK,CAAC,CAAC,CAAC,iBAAiB,CAAC,CAAC,CAAC,iBAAiB,CAAC;gBACzD,KAAK,WAAW;oBACZ,OAAO,KAAK,CAAC,CAAC,CAAC,WAAW,CAAC,CAAC,CAAC,WAAW,CAAC;gBAC7C,KAAK,QAAQ;oBACT,OAAO,KAAK,CAAC,CAAC,CAAC,kBAAkB,CAAC,CAAC,CAAC,iBAAiB,CAAC;gBAC1D;oBACI,OAAO,QAAQ,CAAC;YACxB,CAAC;QACL,CAAC;QACD,OAAO,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,WAAW,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;IACzD,CAAC;IAED,cAAc;QACV,MAAM,UAAU,GAAG,IAAI,CAAC,oBAAoB,EAAE,CAAC;QAC/C,yEAAyE;QACxE,IAAY,CAAC,QAAQ,GAAG,EAAE,GAAG,CAAE,IAAY,CAAC,QAAQ,IAAI,EAAE,CAAC,EAAE,QAAQ,EAAE,UAAU,EAAE,CAAC;QACrF,IAAI,CAAC;YACD,MAAM,aAAa,GAAG,QAAQ,CAAC,aAAa,CAAC,wBAAwB,CAAC,CAAC;YACvE,IAAI,aAAa,IAAK,MAAc,CAAC,wBAAwB,EAAE,CAAC;gBAC5D,MAAM,WAAW,GAAI,MAAc,CAAC,wBAAwB,CAAC,YAAY,EAAE,GAAG,EAAE,CAC5E,QAAQ,CACX,CAAC;gBACF,IAAI,WAAW,EAAE,UAAU,EAAE,QAAQ,EAAE,CAAC;oBACpC,WAAW,CAAC,UAAU,CAAC,QAAQ,CAAE,IAAY,CAAC,UAAU,EAAE,UAAU,CAAC,CAAC;gBAC1E,CAAC;YACL,CAAC;QACL,CAAC;QAAC,MAAM,CAAC;YACL,YAAY;QAChB,CAAC;IACL,CAAC;IAED,UAAU,CAAC,IAAuB,EAAE,OAAwB,IAAI;QAC5D,IAAI,IAAI,KAAK,IAAI;YAAE,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC;QAC3C,IAAI,OAAO,IAAI,KAAK,QAAQ;YAAE,IAAI,CAAC,WAAW,GAAG,IAAI,KAAK,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;aAC/E,IAAI,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC;YAAE,IAAI,CAAC,WAAW,GAAG,CAAC,GAAG,IAAI,CAAC,CAAC;QAC3D,IAAI,CAAC,aAAa,CAAC,KAAK,EAAE,CAAC;QAC3B,IAAI,CAAC,kBAAkB,GAAG,IAAI,CAAC;QAC/B,IAAI,CAAC,sBAAsB,EAAE,CAAC;QAC9B,IAAI,CAAC,iBAAiB,EAAE,CAAC;QACzB,IAAI,CAAC,aAAa,EAAE,CAAC;QACrB,IAAI,CAAC,cAAc,EAAE,CAAC;QACrB,IAAY,CAAC,WAAW,EAAE,CAAC;YACxB,WAAW,EAAE,IAAI,CAAC,WAAW;YAC7B,WAAW,EAAE,IAAI,CAAC,WAAW;SAChC,CAAC,CAAC;IACP,CAAC;IAED,UAAU;QACN,IAAI,IAAI,CAAC,WAAW,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC;YAC9B,IAAI,CAAC,WAAW,CAAC,GAAG,EAAE,CAAC;YACvB,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;QACtC,CAAC;IACL,CAAC;IAED,gBAAgB,CAAC,UAAkB;QAC/B,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;QAClC,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;IACtC,CAAC;IAED,UAAU,CAAC,IAAc;QACrB,IAAI,CAAC,WAAW,GAAG,EAAE,CAAC;QACtB,IAAI,CAAC,UAAU,CAAC,EAAE,EAAE,IAAI,CAAC,CAAC;IAC9B,CAAC;IAED,sBAAsB;QAClB,MAAM,IAAI,GAAG,IAAI,CAAC,OAAO,CAAC;QAC1B,IAAI,CAAC,IAAI;YAAE,OAAO;QAClB;YACI,IAAI,CAAC,eAAe;YACpB,IAAI,CAAC,aAAa;YAClB,IAAI,CAAC,gBAAgB;YACrB,IAAI,CAAC,aAAa;SACrB,CAAC,OAAO,CAAC,EAAE,CAAC,EAAE;YACX,IAAI,EAAE;gBAAE,EAAE,CAAC,SAAS,CAAC,MAAM,CAAC,uBAAuB,CAAC,CAAC;QACzD,CAAC,CAAC,CAAC;QACH,QAAQ,IAAI,CAAC,WAAW,EAAE,CAAC;YACvB,KAAK,UAAU;gBACX,IAAI,CAAC,eAAe,EAAE,SAAS,CAAC,GAAG,CAAC,uBAAuB,CAAC,CAAC;gBAC7D,MAAM;YACV,KAAK,QAAQ;gBACT,IAAI,CAAC,aAAa,EAAE,SAAS,CAAC,GAAG,CAAC,uBAAuB,CAAC,CAAC;gBAC3D,MAAM;YACV,KAAK,WAAW;gBACZ,IAAI,CAAC,gBAAgB,EAAE,SAAS,CAAC,GAAG,CAAC,uBAAuB,CAAC,CAAC;gBAC9D,MAAM;YACV,KAAK,QAAQ;gBACT,IAAI,CAAC,aAAa,EAAE,SAAS,CAAC,GAAG,CAAC,uBAAuB,CAAC,CAAC;gBAC3D,MAAM;QACd,CAAC;IACL,CAAC;IAED,iBAAiB;QACb,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,WAAW;YAAE,OAAO;QACtC,MAAM,KAAK,GAAa,EAAE,CAAC;QAC3B,MAAM,KAAK,GAAG,CACV,MAAM,CAAC,OAAO,EAAE,iBAAiB,EAAE,EAAE;YACrC,QAAQ,CAAC,eAAe,EAAE,IAAI;YAC9B,IAAI,CACP,CAAC,WAAW,EAAE,CAAC;QAChB,MAAM,KAAK,GAAG,KAAK,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;QACrC,IAAI,SAAS,GAAG,EAAE,CAAC;QACnB,QAAQ,IAAI,CAAC,WAAW,EAAE,CAAC;YACvB,KAAK,UAAU;gBACX,SAAS,GAAG,KAAK,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,UAAU,CAAC;gBAC5C,MAAM;YACV,KAAK,QAAQ;gBACT,SAAS,GAAG,KAAK,CAAC,CAAC,CAAC,iBAAiB,CAAC,CAAC,CAAC,iBAAiB,CAAC;gBAC1D,MAAM;YACV,KAAK,WAAW;gBACZ,SAAS,GAAG,KAAK,CAAC,CAAC,CAAC,WAAW,CAAC,CAAC,CAAC,WAAW,CAAC;gBAC9C,MAAM;YACV,KAAK,QAAQ;gBACT,SAAS,GAAG,KAAK,CAAC,CAAC,CAAC,kBAAkB,CAAC,CAAC,CAAC,iBAAiB,CAAC;gBAC3D,MAAM;QACd,CAAC;QACD,KAAK,CAAC,IAAI,CACN,sEAAsE,SAAS,WAAW,CAC7F,CAAC;QACF,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC,IAAI,EAAE,KAAK,EAAE,EAAE;YACrC,IAAI,KAAK,KAAK,CAAC,IAAI,IAAI,CAAC,WAAW,KAAK,UAAU,IAAI,IAAI,KAAK,gBAAgB;gBAAE,OAAO;YACxF,MAAM,YAAY,GAAG,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC,EAAE,KAAK,GAAG,CAAC,CAAC,CAAC;YAC1D,KAAK,CAAC,IAAI,CAAC,oDAAoD,CAAC,CAAC;YACjE,KAAK,CAAC,IAAI,CACN,yFAAyF,YAAY,CAAC,IAAI,CAAC,GAAG,CAAC,KAAK,IAAI,WAAW,CACtI,CAAC;QACN,CAAC,CAAC,CAAC;QACH,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC,SAAS,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;IACxD,CAAC;IAED,aAAa;QACT,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,WAAW;YAAE,OAAO;QACtC,IAAI,IAAI,CAAC,WAAW,KAAK,QAAQ,EAAE,CAAC;YAChC,IAAI,CAAC,mBAAmB,EAAE,CAAC;YAC3B,OAAO;QACX,CAAC;QACD,MAAM,KAAK,GAAG,IAAI,CAAC,eAAe,EAAE,CAAC;QACrC,IAAI,KAAK,CAAC,MAAM,KAAK,CAAC,EAAE,CAAC;YACrB,IAAI,SAAS,GAAG,wBAAwB,CAAC;YACzC,IAAI,CAAC;gBACD,MAAM,IAAI,GAAG,CACT,MAAM,CAAC,OAAO,EAAE,iBAAiB,EAAE,EAAE;oBACrC,QAAQ,CAAC,eAAe,EAAE,IAAI;oBAC9B,IAAI,CACP,CAAC,WAAW,EAAE,CAAC;gBAChB,SAAS,GAAG,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC;oBAC7B,CAAC,CAAC,wBAAwB;oBAC1B,CAAC,CAAC,sBAAsB,CAAC;YACjC,CAAC;YAAC,MAAM,CAAC,CAAA,CAAC;YACV,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC,SAAS,GAAG,oHAAoH,SAAS,cAAc,CAAC;YACjL,OAAO;QACX,CAAC;QACD,MAAM,WAAW,GAAG,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;QAC1C,QAAQ,IAAI,CAAC,QAAQ,EAAE,CAAC;YACpB,KAAK,MAAM;gBACP,IAAI,CAAC,cAAc,CAAC,WAAW,CAAC,CAAC;gBACjC,MAAM;YACV,KAAK,MAAM;gBACP,IAAI,CAAC,cAAc,CAAC,WAAW,CAAC,CAAC;gBACjC,MAAM;YACV,KAAK,SAAS;gBACV,IAAI,CAAC,cAAc,CAAC,WAAW,CAAC,CAAC;gBACjC,MAAM;QACd,CAAC;IACL,CAAC;IAED,eAAe;QACX,QAAQ,IAAI,CAAC,WAAW,EAAE,CAAC;YACvB,KAAK,UAAU;gBACX,OAAO,IAAI,CAAC,gBAAgB,EAAE,CAAC;YACnC,KAAK,QAAQ;gBACT,OAAO,IAAI,CAAC,cAAc,EAAE,CAAC;YACjC,KAAK,WAAW;gBACZ,OAAO,IAAI,CAAC,gBAAgB,EAAE,CAAC;YACnC,KAAK,QAAQ;gBACT,OAAO,IAAI,CAAC,cAAc,EAAE,CAAC;YACjC;gBACI,OAAO,EAAE,CAAC;QAClB,CAAC;IACL,CAAC;IAED,gBAAgB;QACZ,IAAI,OAAO,GAAQ,IAAI,CAAC,iBAAiB,CAAC;QAC1C,KAAK,MAAM,QAAQ,IAAI,IAAI,CAAC,WAAW,EAAE,CAAC;YACtC,IAAI,OAAO,CAAC,QAAQ,CAAC,IAAI,OAAO,CAAC,QAAQ,CAAC,CAAC,QAAQ;gBAC/C,OAAO,GAAG,OAAO,CAAC,QAAQ,CAAC,CAAC,QAAQ,CAAC;;gBACpC,OAAO,EAAE,CAAC;QACnB,CAAC;QACD,OAAO,MAAM,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,IAAI,EAAE,IAAI,CAAgB,EAAE,EAAE,CAAC,CAAC;YACjE,IAAI;YACJ,IAAI,EAAE,IAAI,CAAC,IAAI;YACf,IAAI,EAAE,IAAI,CAAC,IAAI,IAAI,CAAC,IAAI,CAAC,IAAI,KAAK,QAAQ,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC;YACzD,IAAI,EAAE,IAAI,CAAC,IAAI,IAAI,CAAC;YACpB,QAAQ,EAAE,IAAI,CAAC,QAAQ,IAAI,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE;SACtD,CAAC,CAAC,CAAC;IACR,CAAC;IAED,cAAc;QACV,OAAO,EAAE,CAAC;IACd,CAAC;IAED,gBAAgB;QACZ,OAAO,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;YAC3C,IAAI,EAAE,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,GAAG,EAAE,IAAI,IAAI;YACnC,IAAI,EAAE,UAAU;YAChB,IAAI,EAAE,GAAG;YACT,IAAI;SACP,CAAC,CAAC,CAAC;IACR,CAAC;IAED,cAAc;QACV,OAAO,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;YACjC,IAAI,EAAE,IAAI,CAAC,IAAI;YACf,IAAI,EAAE,QAAQ;YACd,IAAI,EAAE,IAAI,CAAC,IAAI,IAAI,IAAI;YACvB,IAAI,EAAE,IAAI,CAAC,IAAI;YACf,QAAQ,EAAE,IAAI,CAAC,QAAQ;SAC1B,CAAC,CAAC,CAAC;IACR,CAAC;IAED,SAAS,CAAC,KAAiB;QACvB,MAAM,MAAM,GAAG,CAAC,GAAG,KAAK,CAAC,CAAC;QAC1B,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE;YACjB,IAAI,CAAC,CAAC,IAAI,KAAK,QAAQ,IAAI,CAAC,CAAC,IAAI,KAAK,QAAQ;gBAAE,OAAO,CAAC,CAAC,CAAC;YAC1D,IAAI,CAAC,CAAC,IAAI,KAAK,QAAQ,IAAI,CAAC,CAAC,IAAI,KAAK,QAAQ;gBAAE,OAAO,CAAC,CAAC;YACzD,IAAI,UAAU,GAAG,CAAC,CAAC;YACnB,QAAQ,IAAI,CAAC,MAAM,EAAE,CAAC;gBAClB,KAAK,MAAM;oBACP,UAAU,GAAG,CAAC,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC;oBAC1C,MAAM;gBACV,KAAK,MAAM;oBACP,UAAU,GAAG,CAAC,CAAC,CAAC,IAAI,IAAI,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,IAAI,IAAI,CAAC,CAAC,CAAC;oBAC3C,MAAM;gBACV,KAAK,MAAM,CAAC,CAAC,CAAC;oBACV,MAAM,KAAK,GAAG,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;oBACtD,MAAM,KAAK,GAAG,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;oBACtD,UAAU,GAAG,KAAK,GAAG,KAAK,CAAC;oBAC3B,MAAM;gBACV,CAAC;gBACD,KAAK,MAAM;oBACP,UAAU,GAAG,CAAC,CAAC,CAAC,IAAI,IAAI,EAAE,CAAC,CAAC,aAAa,CAAC,CAAC,CAAC,IAAI,IAAI,EAAE,CAAC,CAAC;oBACxD,MAAM;YACd,CAAC;YACD,OAAO,IAAI,CAAC,SAAS,KAAK,KAAK,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC;QAC/D,CAAC,CAAC,CAAC;QACH,OAAO,MAAM,CAAC;IAClB,CAAC;IAED,cAAc,CAAC,KAAiB;QAC5B,IAAI,CAAC,cAAc,GAAG,KAAK,CAAC;QAC5B,MAAM,IAAI,GAAG,KAAK;aACb,GAAG,CAAC,CAAC,IAAI,EAAE,CAAC,EAAE,EAAE;YACb,MAAM,UAAU,GAAG,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACrD,MAAM,WAAW,GAAG,UAAU,CAAC,CAAC,CAAC,8BAA8B,CAAC,CAAC,CAAC,EAAE,CAAC;YACrE,OAAO;8CACuB,WAAW,iBAAiB,CAAC,4DAA4D,IAAI,CAAC,IAAI,qBAAqB,IAAI,CAAC,IAAI;yDACrH,IAAI,CAAC,IAAI,IAAI,EAAE,yCAAyC,IAAI,CAAC,IAAI;0BAChG,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC;0BAC1B,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,QAAQ,CAAC;sBAClC,CAAC;QACX,CAAC,CAAC;aACD,IAAI,CAAC,EAAE,CAAC,CAAC;QACd,IAAI,CAAC,OAAO,CAAC,WAAY,CAAC,SAAS,GAAG;;;;;;;;;;yCAUL,IAAI;;;mBAG1B,CAAC;IAChB,CAAC;IAED,cAAc,CAAC,KAAiB;QAC5B,IAAI,CAAC,cAAc,GAAG,KAAK,CAAC;QAC5B,MAAM,KAAK,GAAG,KAAK;aACd,GAAG,CAAC,CAAC,IAAI,EAAE,CAAC,EAAE,EAAE;YACb,MAAM,UAAU,GAAG,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACrD,MAAM,WAAW,GAAG,UAAU;gBAC1B,CAAC,CAAC,iGAAiG;gBACnG,CAAC,CAAC,EAAE,CAAC;YACT,OAAO;6CACsB,WAAW,iBAAiB,CAAC,4DAA4D,IAAI,CAAC,IAAI,qBAAqB,IAAI,CAAC,IAAI;gDAC7H,IAAI,CAAC,IAAI,IAAI,EAAE;gDACf,IAAI,CAAC,IAAI;qBACpC,CAAC;QACV,CAAC,CAAC;aACD,IAAI,CAAC,EAAE,CAAC,CAAC;QACd,IAAI,CAAC,OAAO,CAAC,WAAY,CAAC,SAAS,GAAG;;6DAEe,KAAK;;2BAEvC,CAAC;IACxB,CAAC;IAED,QAAQ,CAAC,IAAY,EAAE,IAAY;QAC/B,IAAI,IAAI,KAAK,QAAQ,EAAE,CAAC;YACpB,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,CAAC;QAChC,CAAC;aAAM,IAAI,IAAI,KAAK,MAAM,EAAE,CAAC;YACzB,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;YACtB,IAAY,CAAC,IAAI,EAAE,CAAC,YAAY,EAAE;gBAC/B,IAAI;gBACJ,IAAI,EAAE,CAAC,GAAG,IAAI,CAAC,WAAW,EAAE,IAAI,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC;aAC9C,CAAC,CAAC;YACH,IAAI,IAAI,CAAC,WAAW,KAAK,QAAQ,EAAE,CAAC;gBAChC,MAAM,IAAI,GAAG,IAAI,CAAC,kBAAkB,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;gBAC/C,MAAM,OAAO,GAAG,kCAAkC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;gBAC9D,IAAI,IAAI,IAAI,OAAO,IAAI,IAAI,CAAC,YAAY,EAAE,CAAC;oBACvC,IAAI,CAAC,eAAe,CAAC,EAAE,GAAG,EAAE,IAAI,CAAC,YAAY,EAAE,IAAI,EAAE,CAAC,CAAC;gBAC3D,CAAC;YACL,CAAC;QACL,CAAC;IACL,CAAC;IAED,KAAK,CAAC,mBAAmB;QACrB,MAAM,EAAE,GAAG,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC;QACpC,IAAI,CAAC,EAAE;YAAE,OAAO;QAChB,IAAI,IAAI,CAAC,WAAW,CAAC,MAAM,KAAK,CAAC,EAAE,CAAC;YAChC,EAAE,CAAC,SAAS,GAAG,0DAA0D,CAAC;YAC1E,MAAM,KAAK,GAAG,MAAM,IAAI,CAAC,gBAAgB,EAAE,CAAC;YAC5C,IAAI,CAAC,kBAAkB,CAAC,KAAK,EAAE,CAAC;YAChC,MAAM,KAAK,GAAG,CAAC,KAAK,IAAI,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC,IAAS,EAAE,EAAE,CAAC,CAAC;gBAC5C,IAAI,EAAE,IAAI,CAAC,IAAI;gBACf,IAAI,EAAE,QAAQ;gBACd,IAAI,EAAE,IAAI;aACb,CAAC,CAAC,CAAC;YACJ,KAAK,CAAC,OAAO,CAAC,CAAC,EAAO,EAAE,EAAE,CAAC,IAAI,CAAC,kBAAkB,CAAC,GAAG,CAAC,EAAE,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC,CAAC;YACrE,IAAI,IAAI,CAAC,WAAW,IAAI,KAAK,CAAC,MAAM,KAAK,CAAC,EAAE,CAAC;gBACzC,EAAE,CAAC,SAAS;oBACR,6LAA6L,CAAC;YACtM,CAAC;iBAAM,IAAI,KAAK,CAAC,MAAM,KAAK,CAAC,EAAE,CAAC;gBAC5B,EAAE,CAAC,SAAS;oBACR,4FAA4F,CAAC;YACrG,CAAC;iBAAM,CAAC;gBACJ,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,CAAC;YAC/B,CAAC;YACD,OAAO;QACX,CAAC;QACD,MAAM,IAAI,GAAG,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC;QACjC,IAAI,CAAC,IAAI,EAAE,CAAC;YACR,OAAO;QACX,CAAC;QACD,MAAM,YAAY,GAAG,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;QAC/C,MAAM,OAAO,GAAG,YAAY,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;QACvC,EAAE,CAAC,SAAS,GAAG,qDAAqD,CAAC;QACrE,MAAM,QAAQ,GAAG,MAAM,IAAI,CAAC,mBAAmB,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;QAC/D,IAAI,CAAC,kBAAkB,CAAC,KAAK,EAAE,CAAC;QAChC,MAAM,KAAK,GAAG,CAAC,QAAQ,IAAI,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC,KAAU,EAAE,EAAE;YAC9C,MAAM,KAAK,GAAG,KAAK,CAAC,IAAI,KAAK,KAAK,CAAC;YACnC,OAAO;gBACH,IAAI,EAAE,KAAK,CAAC,IAAI;gBAChB,IAAI,EAAE,KAAK,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,MAAM;gBAC/B,IAAI,EAAE,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI;gBACzB,IAAI,EAAE,KAAK,CAAC,IAAI,IAAI,CAAC;gBACrB,YAAY,EAAE,KAAK,CAAC,YAAY,IAAI,IAAI;aAC/B,CAAC;QAClB,CAAC,CAAC,CAAC;QACH,KAAK,CAAC,OAAO,CAAC,CAAC,EAAO,EAAE,EAAE,CAAC,IAAI,CAAC,kBAAkB,CAAC,GAAG,CAAC,EAAE,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC,CAAC;QACrE,IAAI,IAAI,CAAC,WAAW,IAAI,KAAK,CAAC,MAAM,KAAK,CAAC,EAAE,CAAC;YACzC,EAAE,CAAC,SAAS;gBACR,6LAA6L,CAAC;QACtM,CAAC;aAAM,IAAI,KAAK,CAAC,MAAM,KAAK,CAAC,EAAE,CAAC;YAC5B,EAAE,CAAC,SAAS;gBACR,0EAA0E,CAAC;QACnF,CAAC;aAAM,CAAC;YACJ,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,CAAC;QAC/B,CAAC;IACL,CAAC;IAED,KAAK,CAAC,gBAAgB;QAClB,MAAM,eAAe,GAAG,UAAU,CAAC;QACnC,IAAI,CAAC;YACD,IAAI,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,WAAW,CAAC,IAAI,IAAI,CAAC,WAAW,CAAC,MAAM;gBAAE,OAAO,IAAI,CAAC,WAAW,CAAC;YACxF,MAAM,GAAG,GAAG,MAAM,KAAK,CAAC,gCAAgC,eAAe,QAAQ,EAAE;gBAC7E,OAAO,EAAE,EAAE,MAAM,EAAE,gCAAgC,EAAE;aACxD,CAAC,CAAC;YACH,IAAI,CAAC,GAAG,CAAC,EAAE;gBAAE,MAAM,IAAI,KAAK,CAAC,2BAA2B,CAAC,CAAC;YAC1D,MAAM,IAAI,GAAG,MAAM,GAAG,CAAC,IAAI,EAAE,CAAC;YAC9B,IAAI,CAAC,WAAW,GAAG,IAAI,IAAI,EAAE,CAAC;YAC9B,IAAI,CAAC,WAAW,GAAG,KAAK,CAAC;YACzB,IAAI,CAAC,kBAAkB,GAAG,EAAE,CAAC;YAC7B,OAAO,IAAI,CAAC,WAAW,CAAC;QAC5B,CAAC;QAAC,OAAO,CAAC,EAAE,CAAC;YACT,OAAO,CAAC,IAAI,CAAC,qBAAqB,EAAE,CAAC,CAAC,CAAC;YACvC,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC;YACxB,IAAI,CAAC,kBAAkB,GAAG,kCAAkC,CAAC;YAC7D,OAAO,EAAE,CAAC;QACd,CAAC;IACL,CAAC;IAED,KAAK,CAAC,mBAAmB,CAAC,IAAY,EAAE,OAAO,GAAG,EAAE;QAChD,IAAI,CAAC;YACD,MAAM,GAAG,GAAG,GAAG,IAAI,IAAI,OAAO,EAAE,CAAC;YACjC,IAAI,IAAI,CAAC,kBAAkB,CAAC,GAAG,CAAC,GAAG,CAAC;gBAAE,OAAO,IAAI,CAAC,kBAAkB,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;YAC9E,MAAM,IAAI,GAAG,yCAAyC,IAAI,WAAW,CAAC;YACtE,MAAM,GAAG,GAAG,OAAO,CAAC,CAAC,CAAC,GAAG,IAAI,IAAI,IAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC;YAC1E,MAAM,GAAG,GAAG,MAAM,KAAK,CAAC,GAAG,EAAE,EAAE,OAAO,EAAE,EAAE,MAAM,EAAE,gCAAgC,EAAE,EAAE,CAAC,CAAC;YACxF,IAAI,CAAC,GAAG,CAAC,EAAE;gBAAE,MAAM,IAAI,KAAK,CAAC,8BAA8B,CAAC,CAAC;YAC7D,MAAM,IAAI,GAAG,MAAM,GAAG,CAAC,IAAI,EAAE,CAAC;YAC9B,IAAI,CAAC,kBAAkB,CAAC,GAAG,CAAC,GAAG,EAAE,IAAI,IAAI,EAAE,CAAC,CAAC;YAC7C,IAAI,CAAC,WAAW,GAAG,KAAK,CAAC;YACzB,IAAI,CAAC,kBAAkB,GAAG,EAAE,CAAC;YAC7B,OAAO,IAAI,CAAC;QAChB,CAAC;QAAC,OAAO,CAAC,EAAE,CAAC;YACT,OAAO,CAAC,IAAI,CAAC,wBAAwB,EAAE,CAAC,CAAC,CAAC;YAC1C,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC;YACxB,IAAI,CAAC,kBAAkB,GAAG,kCAAkC,CAAC;YAC7D,OAAO,EAAE,CAAC;QACd,CAAC;IACL,CAAC;IAEO,iBAAiB,CAAC,OAAe;QACrC,IAAI,CAAC,OAAO;YAAE,OAAO,EAAE,CAAC;QACxB,OAAO,OAAO;aACT,KAAK,CAAC,GAAG,CAAC;aACV,MAAM,CAAC,OAAO,CAAC;aACf,GAAG,CAAC,GAAG,CAAC,EAAE,CAAC,kBAAkB,CAAC,GAAG,CAAC,CAAC;aACnC,IAAI,CAAC,GAAG,CAAC,CAAC;IACnB,CAAC;IAED,eAAe,CAAC,EAAE,GAAG,EAAE,IAAI,EAAiC;QACxD,IAAI,CAAC;YACD,MAAM,GAAG,GAAG,QAAQ,CAAC,cAAc,CAAC,cAAc,CAA4B,CAAC;YAC/E,MAAM,IAAI,GAAG,QAAQ,CAAC,cAAc,CAAC,YAAY,CAAC,CAAC;YACnD,MAAM,WAAW,GAAG,QAAQ,CAAC,cAAc,CAAC,mBAAmB,CAAC,CAAC;YACjE,IAAI,IAAI,EAAE,CAAC;gBACP,IAAI,CAAC,WAAW,GAAG,IAAI,IAAI,EAAE,CAAC;gBAC9B,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;YACpC,CAAC;YACD,IAAI,WAAW;gBAAE,WAAW,CAAC,SAAS,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;YACrD,IAAI,GAAG,EAAE,CAAC;gBACN,GAAG,CAAC,GAAG,GAAG,GAAG,CAAC;gBACd,GAAG,CAAC,SAAS,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;YACnC,CAAC;YACD,IAAI,MAAM,CAAC,SAAS,IAAI,OAAO,MAAM,CAAC,SAAS,CAAC,iBAAiB,KAAK,UAAU,EAAE,CAAC;gBAC/E,MAAM,CAAC,SAAS,CAAC,iBAAiB,CAAC,EAAE,GAAG,EAAE,IAAI,EAAE,CAAC,CAAC;YACtD,CAAC;YACD,IAAI,MAAM,CAAC,GAAG,EAAE,MAAM,EAAE,IAAI,EAAE,CAAC;gBAC3B,MAAM,CAAC,GAAG,CAAC,MAAM,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;YAC1C,CAAC;iBAAM,CAAC;gBACJ,MAAM,KAAK,GAAG,QAAQ,CAAC,cAAc,CAAC,aAAa,CAAC,CAAC;gBACrD,IAAI,KAAK;oBAAE,KAAK,CAAC,SAAS,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;YAChD,CAAC;QACL,CAAC;QAAC,OAAO,CAAC,EAAE,CAAC;YACT,OAAO,CAAC,IAAI,CAAC,8BAA8B,EAAE,CAAC,CAAC,CAAC;QACpD,CAAC;IACL,CAAC;IAED,WAAW,CAAC,IAAY;QACpB,MAAM,QAAQ,GAAG,CAAC,GAAG,IAAI,CAAC,WAAW,EAAE,IAAI,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;QACvD,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC;YACrB,IAAI;YACJ,IAAI,EAAE,QAAQ;YACd,IAAI,EAAE,IAAI;YACV,QAAQ,EAAE,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE;SACrC,CAAC,CAAC;QACH,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC;QAChD,IAAY,CAAC,WAAW,EAAE,CAAC,EAAE,WAAW,EAAE,IAAI,CAAC,WAAW,EAAE,CAAC,CAAC;IACnE,CAAC;IAED,SAAS,CAAC,KAA4B;QAClC,IAAI,IAAI,CAAC,MAAM,KAAK,KAAK;YAAE,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,SAAS,KAAK,KAAK,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,KAAK,CAAC;aACjF,CAAC;YACF,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;YACpB,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC;QAC3B,CAAC;QACD,IAAI,CAAC,aAAa,EAAE,CAAC;QACpB,IAAY,CAAC,WAAW,EAAE,CAAC,EAAE,MAAM,EAAE,IAAI,CAAC,MAAM,EAAE,SAAS,EAAE,IAAI,CAAC,SAAS,EAAE,CAAC,CAAC;IACpF,CAAC;IAED,WAAW,CAAC,IAAc;QACtB,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;QACrB,IAAI,CAAC,aAAa,EAAE,CAAC;QACpB,IAAY,CAAC,WAAW,EAAE,CAAC,EAAE,QAAQ,EAAE,IAAI,CAAC,QAAQ,EAAE,CAAC,CAAC;IAC7D,CAAC;IAED,UAAU,CAAC,KAAc;QACrB,IAAI,CAAC,KAAK,IAAI,KAAK,KAAK,CAAC;YAAE,OAAO,GAAG,CAAC;QACtC,IAAI,KAAK,GAAG,IAAI;YAAE,OAAO,KAAK,GAAG,IAAI,CAAC;QACtC,IAAI,KAAK,GAAG,IAAI,GAAG,IAAI;YAAE,OAAO,CAAC,KAAK,GAAG,IAAI,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC;QAClE,OAAO,CAAC,KAAK,GAAG,CAAC,IAAI,GAAG,IAAI,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC;IACtD,CAAC;IAED,UAAU,CAAC,OAAgB;QACvB,IAAI,CAAC,OAAO;YAAE,OAAO,GAAG,CAAC;QACzB,MAAM,IAAI,GAAG,IAAI,IAAI,CAAC,OAAO,CAAC,CAAC;QAC/B,OAAO,IAAI,CAAC,kBAAkB,CAAC,OAAO,EAAE;YACpC,GAAG,EAAE,SAAS;YACd,KAAK,EAAE,SAAS;YAChB,IAAI,EAAE,SAAS;SAClB,CAAC,CAAC;IACP,CAAC;IAED,SAAS;QACL,OAAO;YACH,GAAG,CAAC,KAAK,CAAC,SAAS,EAAE,EAAE,IAAI,EAAE,CAAC;YAC9B,WAAW,EAAE,IAAI,CAAC,WAAW;YAC7B,WAAW,EAAE,IAAI,CAAC,WAAW;YAC7B,QAAQ,EAAE,IAAI,CAAC,QAAQ;YACvB,MAAM,EAAE,IAAI,CAAC,MAAM;YACnB,SAAS,EAAE,IAAI,CAAC,SAAS;YACzB,SAAS,EAAE,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC;YACrC,WAAW,EAAE,IAAI,CAAC,WAAW;SAChC,CAAC;IACN,CAAC;IAED,WAAW,CAAC,IAAS;QAChB,IAAY,CAAC,kBAAkB,GAAG,IAAI,CAAC;QACxC,KAAK,CAAC,WAAW,EAAE,CAAC,IAAI,CAAC,CAAC;QAC1B,IAAI,IAAI,CAAC,WAAW;YAAE,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,WAAW,CAAC;QAC1D,IAAI,IAAI,CAAC,WAAW;YAAE,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,WAAW,CAAC;QAC1D,IAAI,IAAI,CAAC,QAAQ;YAAE,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC;QACjD,IAAI,IAAI,CAAC,MAAM;YAAE,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC;QAC3C,IAAI,IAAI,CAAC,SAAS;YAAE,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC;QACpD,IAAI,IAAI,CAAC,SAAS;YAAE,IAAI,CAAC,SAAS,GAAG,IAAI,GAAG,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;QAC7D,IAAI,IAAI,CAAC,WAAW;YAAE,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,WAAW,CAAC;QAC1D,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,WAAW,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;IACxD,CAAC;IAED,KAAK;QACD,KAAK,CAAC,KAAK,EAAE,EAAE,CAAC;QAChB,8CAA8C;IAClD,CAAC;CACJ;AAED,gEAAgE;AAChE,MAAM,CAAC,cAAc,GAAG,cAAqB,CAAC;AAE9C,IAAI,MAAM,CAAC,eAAe,EAAE,CAAC;IACzB,MAAM,CAAC,qBAAqB,GAAG,IAAI,MAAM,CAAC,eAAe,CAAC;QACtD,IAAI,EAAE,QAAQ;QACd,aAAa,EAAE,cAAc;QAC7B,YAAY,EAAE,CAAC;QACf,eAAe,EAAE,UAAU,UAAkB;YACzC,MAAM,oBAAoB,GAAG,QAAQ,CAAC,cAAc,CAAC,kBAAkB,CAAC,CAAC;YACzE,MAAM,SAAS,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;YAChD,SAAS,CAAC,EAAE,GAAG,GAAG,UAAU,YAAY,CAAC;YACzC,SAAS,CAAC,SAAS;gBACf,8EAA8E,CAAC;YACnF,SAAS,CAAC,SAAS,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;YAClC,IAAI,oBAAoB,EAAE,CAAC;gBACvB,oBAAoB,CAAC,WAAW,CAAC,SAAS,CAAC,CAAC;YAChD,CAAC;iBAAM,CAAC;gBACJ,OAAO,CAAC,KAAK,CAAC,6DAA6D,CAAC,CAAC;gBAC7E,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,CAAC;YACzC,CAAC;YACD,OAAO,SAAS,CAAC;QACrB,CAAC;KACJ,CAAC,CAAC;AACP,CAAC","sourcesContent":["/*\r\n * finder-instance.ts\r\n * TypeScript port of the multi-instance Finder implementation.\r\n * Exposes window.FinderInstance and window.FinderInstanceManager for compatibility.\r\n */\r\n\r\n/* eslint-disable @typescript-eslint/no-explicit-any */\r\n\r\ndeclare global {\r\n    interface Window {\r\n        FinderInstance?: any;\r\n        FinderInstanceManager?: any;\r\n    }\r\n}\r\n\r\nconst ROOT_FOLDER_NAME = 'Computer';\r\n\r\ntype ViewMode = 'list' | 'grid' | 'columns';\r\ntype ViewKind = 'computer' | 'github' | 'favorites' | 'recent';\r\n\r\ninterface FileItem {\r\n    name: string;\r\n    type: 'folder' | 'file' | 'favorite' | 'recent' | string;\r\n    icon?: string;\r\n    size?: number;\r\n    modified?: string;\r\n    download_url?: string | null;\r\n    path?: string;\r\n}\r\n\r\ninterface FinderState {\r\n    currentPath: string[];\r\n    currentView: ViewKind;\r\n    viewMode: ViewMode;\r\n    sortBy: 'name' | 'date' | 'size' | 'type';\r\n    sortOrder: 'asc' | 'desc';\r\n    favorites: string[];\r\n    recentFiles: Array<{ name: string; path: string; icon?: string; modified: string }>;\r\n}\r\n\r\nclass FinderInstance extends (window.BaseWindowInstance || class {}) {\r\n    currentPath: string[] = [];\r\n    currentView: ViewKind = 'computer';\r\n    selectedItems: Set<string> = new Set();\r\n    viewMode: ViewMode = 'list';\r\n    sortBy: 'name' | 'date' | 'size' | 'type' = 'name';\r\n    sortOrder: 'asc' | 'desc' = 'asc';\r\n    githubRepos: any[] = [];\r\n    githubLoading = false;\r\n    githubError = false;\r\n    githubErrorMessage = '';\r\n    lastGithubItemsMap: Map<string, any> = new Map();\r\n    favorites: Set<string> = new Set();\r\n    recentFiles: Array<{ name: string; path: string; icon?: string; modified: string }> = [];\r\n    _lastSelectedIndex: number | null = null;\r\n    _renderedItems: FileItem[] = [];\r\n    domRefs: {\r\n        sidebarComputer: HTMLElement | null;\r\n        sidebarGithub: HTMLElement | null;\r\n        sidebarFavorites: HTMLElement | null;\r\n        sidebarRecent: HTMLElement | null;\r\n        breadcrumbs: HTMLElement | null;\r\n        contentArea: HTMLElement | null;\r\n        toolbar: HTMLElement | null;\r\n        searchInput: HTMLInputElement | null;\r\n    } = {\r\n        sidebarComputer: null,\r\n        sidebarGithub: null,\r\n        sidebarFavorites: null,\r\n        sidebarRecent: null,\r\n        breadcrumbs: null,\r\n        contentArea: null,\r\n        toolbar: null,\r\n        searchInput: null,\r\n    };\r\n\r\n    githubContentCache: Map<string, any[]> = new Map();\r\n    virtualFileSystem: Record<string, any> = {};\r\n    _skipInitialRender?: boolean;\r\n\r\n    constructor(config: any) {\r\n        super({ ...config, type: 'finder' });\r\n        this.selectedItems = new Set();\r\n        this._lastSelectedIndex = null;\r\n        this._renderedItems = [];\r\n        this.githubContentCache = new Map();\r\n        this.virtualFileSystem = this._createVirtualFileSystem();\r\n    }\r\n\r\n    private _createVirtualFileSystem() {\r\n        const rootFolder = {\r\n            type: 'folder',\r\n            icon: '💻',\r\n            children: {\r\n                Documents: {\r\n                    type: 'folder',\r\n                    icon: '📄',\r\n                    children: {\r\n                        'README.md': {\r\n                            type: 'file',\r\n                            icon: '📝',\r\n                            content:\r\n                                '# Willkommen im Finder\\n\\nDies ist ein virtuelles Dateisystem.',\r\n                            size: 1024,\r\n                        },\r\n                    },\r\n                },\r\n                Downloads: { type: 'folder', icon: '⬇️', children: {} },\r\n                Pictures: { type: 'folder', icon: '🖼️', children: {} },\r\n                Music: { type: 'folder', icon: '🎵', children: {} },\r\n                Videos: { type: 'folder', icon: '🎬', children: {} },\r\n            },\r\n        };\r\n        return { [ROOT_FOLDER_NAME]: rootFolder };\r\n    }\r\n\r\n    protected _initializeState(initialState: Partial<FinderState>) {\r\n        return {\r\n            currentPath: initialState.currentPath || [],\r\n            currentView: (initialState.currentView as ViewKind) || 'computer',\r\n            viewMode: (initialState.viewMode as ViewMode) || 'list',\r\n            sortBy: (initialState.sortBy as FinderState['sortBy']) || 'name',\r\n            sortOrder: (initialState.sortOrder as FinderState['sortOrder']) || 'asc',\r\n            favorites: initialState.favorites || [],\r\n            recentFiles: initialState.recentFiles || [],\r\n        } as FinderState;\r\n    }\r\n\r\n    render() {\r\n        if (!this.container) return;\r\n        const html = `\r\n            <div class=\"finder-instance-wrapper flex-1 flex gap-0 min-h-0 overflow-hidden\">\r\n                <aside class=\"w-48 bg-gray-50 dark:bg-gray-900 border-r border-gray-200 dark:border-gray-700 overflow-y-auto\">\r\n                    <div class=\"py-2\">\r\n                        <div class=\"px-3 py-1 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wide\" data-i18n=\"finder.sidebar.favorites\">Favoriten</div>\r\n                        <button id=\"finder-sidebar-computer\" data-finder-sidebar-computer data-action=\"finder:switchView\" data-finder-view=\"computer\" class=\"finder-sidebar-item finder-sidebar-active\">\r\n                            <span class=\"finder-sidebar-icon\">💻</span>\r\n                            <span data-i18n=\"finder.sidebar.computer\">Computer</span>\r\n                        </button>\r\n                        <button id=\"finder-sidebar-recent\" data-finder-sidebar-recent data-action=\"finder:switchView\" data-finder-view=\"recent\" class=\"finder-sidebar-item\">\r\n                            <span class=\"finder-sidebar-icon\">🕒</span>\r\n                            <span data-i18n=\"finder.sidebar.recent\">Zuletzt geöffnet</span>\r\n                        </button>\r\n                        <div class=\"px-3 py-1 mt-4 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wide\" data-i18n=\"finder.sidebar.locations\">Orte</div>\r\n                        <button id=\"finder-sidebar-github\" data-finder-sidebar-github data-action=\"finder:switchView\" data-finder-view=\"github\" class=\"finder-sidebar-item\">\r\n                            <span class=\"finder-sidebar-icon\">📂</span>\r\n                            <span data-i18n=\"finder.sidebar.github\">GitHub Projekte</span>\r\n                        </button>\r\n                        <button id=\"finder-sidebar-favorites\" data-finder-sidebar-favorites data-action=\"finder:switchView\" data-finder-view=\"favorites\" class=\"finder-sidebar-item\">\r\n                            <span class=\"finder-sidebar-icon\">⭐</span>\r\n                            <span data-i18n=\"finder.sidebar.starred\">Mit Stern</span>\r\n                        </button>\r\n                    </div>\r\n                </aside>\r\n                <div class=\"flex-1 flex flex-col min-h-0\">\r\n                    <div id=\"finder-toolbar\" data-finder-toolbar class=\"px-4 py-2 border-b border-gray-200 dark:border-gray-700 flex items-center gap-2\">\r\n                        <button data-action=\"finder:navigateUp\" class=\"finder-toolbar-btn\" title=\"Zurück\" data-i18n-title=\"finder.toolbar.back\">\r\n                            <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><path d=\"M19 12H5M12 19l-7-7 7-7\" /></svg>\r\n                        </button>\r\n                        <button data-action=\"finder:goRoot\" class=\"finder-toolbar-btn\" title=\"Vorwärts\" data-i18n-title=\"finder.toolbar.forward\">\r\n                            <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><path d=\"M5 12h14M12 5l7 7-7 7\" /></svg>\r\n                        </button>\r\n                        <div class=\"flex-1 mx-2\">\r\n                            <div id=\"finder-path-breadcrumbs\" data-finder-breadcrumbs class=\"flex items-center gap-1 text-sm text-gray-600 dark:text-gray-400\"></div>\r\n                        </div>\r\n                        <div class=\"flex gap-1\">\r\n                            <button data-action=\"finder:setViewMode\" data-view-mode=\"list\" class=\"finder-toolbar-btn\" title=\"Listenansicht\" data-i18n-title=\"finder.toolbar.listView\">\r\n                                <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"currentColor\"><path d=\"M3 4h18v2H3V4m0 7h18v2H3v-2m0 7h18v2H3v-2Z\" /></svg>\r\n                            </button>\r\n                            <button data-action=\"finder:setViewMode\" data-view-mode=\"grid\" class=\"finder-toolbar-btn\" title=\"Rasteransicht\" data-i18n-title=\"finder.toolbar.gridView\">\r\n                                <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"currentColor\"><path d=\"M3 3h8v8H3V3m10 0h8v8h-8V3M3 13h8v8H3v-8m10 0h8v8h-8v-8Z\" /></svg>\r\n                            </button>\r\n                        </div>\r\n                        <input id=\"finder-search-input\" data-finder-search type=\"text\" placeholder=\"Suchen\" data-i18n-placeholder=\"finder.toolbar.search\" class=\"px-3 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500\" />\r\n                    </div>\r\n                    <div id=\"finder-content-area\" data-finder-content class=\"flex-1 overflow-auto bg-white dark:bg-gray-800 p-4\"></div>\r\n                </div>\r\n            </div>`;\r\n\r\n        this.container.innerHTML = html;\r\n\r\n        this.domRefs.sidebarComputer = this.container.querySelector(\r\n            '[data-finder-sidebar-computer]'\r\n        );\r\n        this.domRefs.sidebarGithub = this.container.querySelector('[data-finder-sidebar-github]');\r\n        this.domRefs.sidebarFavorites = this.container.querySelector(\r\n            '[data-finder-sidebar-favorites]'\r\n        );\r\n        this.domRefs.sidebarRecent = this.container.querySelector('[data-finder-sidebar-recent]');\r\n        this.domRefs.breadcrumbs = this.container.querySelector('[data-finder-breadcrumbs]');\r\n        this.domRefs.contentArea = this.container.querySelector('[data-finder-content]');\r\n        this.domRefs.toolbar = this.container.querySelector('[data-finder-toolbar]');\r\n        this.domRefs.searchInput = this.container.querySelector('[data-finder-search]');\r\n\r\n        try {\r\n            if (window.appI18n && typeof window.appI18n.applyTranslations === 'function') {\r\n                window.appI18n.applyTranslations();\r\n            }\r\n        } catch {\r\n            /* noop */\r\n        }\r\n    }\r\n\r\n    attachEventListeners() {\r\n        if (!this.container) return;\r\n        this.container.addEventListener('click', (e: Event) => this._handleClick(e));\r\n        this.container.addEventListener('dblclick', (e: Event) => this._handleDoubleClick(e));\r\n        if (!(this as any)._skipInitialRender) {\r\n            this.navigateTo(\r\n                (this as any).state?.currentPath || [],\r\n                (this as any).state?.currentView || this.currentView\r\n            );\r\n        }\r\n    }\r\n\r\n    private _handleClick(e: any) {\r\n        const contentRoot: HTMLElement | null = this.domRefs?.contentArea || this.container;\r\n        if (contentRoot && contentRoot.contains(e.target)) {\r\n            const itemEl: HTMLElement | null =\r\n                e.target.closest?.('.finder-list-item, .finder-grid-item') || null;\r\n            const isEmptySpacer = (e.target as HTMLElement).id === 'finder-empty-spacer';\r\n            const isContainerClick = (e.target as HTMLElement).id === 'finder-list-container';\r\n            if (!itemEl || isEmptySpacer || isContainerClick) {\r\n                if (this.selectedItems.size) {\r\n                    this.selectedItems.clear();\r\n                    this._lastSelectedIndex = null;\r\n                    // Optimistically remove selection classes before re-render\r\n                    try {\r\n                        const rows = contentRoot.querySelectorAll('.finder-list-item');\r\n                        rows.forEach((r: Element) => {\r\n                            (r as HTMLElement).classList.remove('bg-blue-100', 'dark:bg-blue-900');\r\n                        });\r\n                    } catch {}\r\n                    this.renderContent();\r\n                }\r\n                // If click did not hit an item, treat as background click and stop further handling\r\n                if (!itemEl || isEmptySpacer || isContainerClick) {\r\n                    e.stopPropagation?.();\r\n                    e.preventDefault?.();\r\n                    return;\r\n                }\r\n            }\r\n        }\r\n\r\n        const clickedItem: HTMLElement | null =\r\n            e.target.closest?.('.finder-list-item, .finder-grid-item') || null;\r\n        if (clickedItem && (clickedItem as any).dataset) {\r\n            const name = (clickedItem as any).dataset.itemName as string;\r\n            const type = (clickedItem as any).dataset.itemType as string;\r\n            const idxStr = (clickedItem as any).dataset.index as string;\r\n            const index = typeof idxStr === 'string' ? parseInt(idxStr, 10) : NaN;\r\n            if (name && type) {\r\n                this._handleItemSelection({ name, type, index, event: e });\r\n                e.stopPropagation?.();\r\n                e.preventDefault?.();\r\n                return;\r\n            }\r\n        }\r\n\r\n        const action = e.target.closest?.('[data-action]')?.dataset.action as string | undefined;\r\n        if (!action) return;\r\n\r\n        const handlers: Record<string, () => void> = {\r\n            'finder:switchView': () => {\r\n                const view = e.target.closest('[data-finder-view]')?.dataset.finderView as ViewKind;\r\n                if (view) this.switchView(view);\r\n            },\r\n            'finder:navigateUp': () => this.navigateUp(),\r\n            'finder:goRoot': () => this.navigateTo([], this.currentView),\r\n            'finder:navigateToPath': () => {\r\n                const path = e.target.closest('[data-path]')?.dataset.path as string;\r\n                if (path !== undefined) this.navigateTo(path);\r\n            },\r\n            'finder:setSortBy': () => {\r\n                const sortBy = e.target.closest('[data-sort-by]')?.dataset\r\n                    .sortBy as FinderState['sortBy'];\r\n                if (sortBy) this.setSortBy(sortBy);\r\n            },\r\n            'finder:setViewMode': () => {\r\n                const mode = e.target.closest('[data-view-mode]')?.dataset.viewMode as ViewMode;\r\n                if (mode) this.setViewMode(mode);\r\n            },\r\n        };\r\n\r\n        if (handlers[action]) handlers[action]();\r\n    }\r\n\r\n    private _handleDoubleClick(e: any) {\r\n        const item = e.target.closest?.('[data-action-dblclick]');\r\n        if (!item || item.dataset.actionDblclick !== 'finder:openItem') return;\r\n        const name = item.dataset.itemName as string;\r\n        const type = item.dataset.itemType as string;\r\n        if (name && type) this.openItem(name, type);\r\n    }\r\n\r\n    private _handleItemSelection({\r\n        name,\r\n        type: _type,\r\n        index,\r\n        event,\r\n    }: {\r\n        name: string;\r\n        type: string;\r\n        index: number;\r\n        event: any;\r\n    }) {\r\n        const isShift = !!event.shiftKey;\r\n        const isToggle = !!(event.metaKey || event.ctrlKey);\r\n        const count = Array.isArray(this._renderedItems) ? this._renderedItems.length : 0;\r\n\r\n        if (isShift && count > 0 && this._lastSelectedIndex !== null && !Number.isNaN(index)) {\r\n            const start = Math.max(0, Math.min(this._lastSelectedIndex, index));\r\n            const end = Math.min(count - 1, Math.max(this._lastSelectedIndex, index));\r\n            if (!isToggle) this.selectedItems.clear();\r\n            for (let i = start; i <= end; i++) {\r\n                const it = this._renderedItems[i];\r\n                if (it && it.name) this.selectedItems.add(it.name);\r\n            }\r\n        } else if (isToggle) {\r\n            if (this.selectedItems.has(name)) this.selectedItems.delete(name);\r\n            else this.selectedItems.add(name);\r\n            this._lastSelectedIndex = Number.isNaN(index) ? null : index;\r\n        } else {\r\n            this.selectedItems.clear();\r\n            this.selectedItems.add(name);\r\n            this._lastSelectedIndex = Number.isNaN(index) ? null : index;\r\n        }\r\n        this.renderContent();\r\n    }\r\n\r\n    getCurrentFolderName() {\r\n        const _lang = (\r\n            window.appI18n?.getActiveLanguage?.() ||\r\n            document.documentElement?.lang ||\r\n            'de'\r\n        ).toLowerCase();\r\n        const _isDe = _lang.startsWith('de');\r\n        if (this.currentPath.length === 0) {\r\n            switch (this.currentView) {\r\n                case 'computer':\r\n                    return _isDe ? 'Computer' : 'Computer';\r\n                case 'github':\r\n                    return _isDe ? 'GitHub Projekte' : 'GitHub Projects';\r\n                case 'favorites':\r\n                    return _isDe ? 'Favoriten' : 'Favorites';\r\n                case 'recent':\r\n                    return _isDe ? 'Zuletzt geöffnet' : 'Recently opened';\r\n                default:\r\n                    return 'Finder';\r\n            }\r\n        }\r\n        return this.currentPath[this.currentPath.length - 1];\r\n    }\r\n\r\n    updateTabTitle() {\r\n        const folderName = this.getCurrentFolderName();\r\n        // Only update the visible tab label, do not overwrite the instance title\r\n        (this as any).metadata = { ...((this as any).metadata || {}), tabLabel: folderName };\r\n        try {\r\n            const tabController = document.querySelector('#finder-tabs-container');\r\n            if (tabController && (window as any).multiInstanceIntegration) {\r\n                const integration = (window as any).multiInstanceIntegration.integrations?.get?.(\r\n                    'finder'\r\n                );\r\n                if (integration?.tabManager?.setTitle) {\r\n                    integration.tabManager.setTitle((this as any).instanceId, folderName);\r\n                }\r\n            }\r\n        } catch {\r\n            /* ignore */\r\n        }\r\n    }\r\n\r\n    navigateTo(path: string | string[], view: ViewKind | null = null) {\r\n        if (view !== null) this.currentView = view;\r\n        if (typeof path === 'string') this.currentPath = path === '' ? [] : path.split('/');\r\n        else if (Array.isArray(path)) this.currentPath = [...path];\r\n        this.selectedItems.clear();\r\n        this._lastSelectedIndex = null;\r\n        this.updateSidebarSelection();\r\n        this.renderBreadcrumbs();\r\n        this.renderContent();\r\n        this.updateTabTitle();\r\n        (this as any).updateState?.({\r\n            currentPath: this.currentPath,\r\n            currentView: this.currentView,\r\n        });\r\n    }\r\n\r\n    navigateUp() {\r\n        if (this.currentPath.length > 0) {\r\n            this.currentPath.pop();\r\n            this.navigateTo(this.currentPath);\r\n        }\r\n    }\r\n\r\n    navigateToFolder(folderName: string) {\r\n        this.currentPath.push(folderName);\r\n        this.navigateTo(this.currentPath);\r\n    }\r\n\r\n    switchView(view: ViewKind) {\r\n        this.currentPath = [];\r\n        this.navigateTo([], view);\r\n    }\r\n\r\n    updateSidebarSelection() {\r\n        const refs = this.domRefs;\r\n        if (!refs) return;\r\n        [\r\n            refs.sidebarComputer,\r\n            refs.sidebarGithub,\r\n            refs.sidebarFavorites,\r\n            refs.sidebarRecent,\r\n        ].forEach(el => {\r\n            if (el) el.classList.remove('finder-sidebar-active');\r\n        });\r\n        switch (this.currentView) {\r\n            case 'computer':\r\n                refs.sidebarComputer?.classList.add('finder-sidebar-active');\r\n                break;\r\n            case 'github':\r\n                refs.sidebarGithub?.classList.add('finder-sidebar-active');\r\n                break;\r\n            case 'favorites':\r\n                refs.sidebarFavorites?.classList.add('finder-sidebar-active');\r\n                break;\r\n            case 'recent':\r\n                refs.sidebarRecent?.classList.add('finder-sidebar-active');\r\n                break;\r\n        }\r\n    }\r\n\r\n    renderBreadcrumbs() {\r\n        if (!this.domRefs.breadcrumbs) return;\r\n        const parts: string[] = [];\r\n        const _lang = (\r\n            window.appI18n?.getActiveLanguage?.() ||\r\n            document.documentElement?.lang ||\r\n            'de'\r\n        ).toLowerCase();\r\n        const _isDe = _lang.startsWith('de');\r\n        let viewLabel = '';\r\n        switch (this.currentView) {\r\n            case 'computer':\r\n                viewLabel = _isDe ? 'Computer' : 'Computer';\r\n                break;\r\n            case 'github':\r\n                viewLabel = _isDe ? 'GitHub Projekte' : 'GitHub Projects';\r\n                break;\r\n            case 'favorites':\r\n                viewLabel = _isDe ? 'Favoriten' : 'Favorites';\r\n                break;\r\n            case 'recent':\r\n                viewLabel = _isDe ? 'Zuletzt geöffnet' : 'Recently opened';\r\n                break;\r\n        }\r\n        parts.push(\r\n            `<button class=\"finder-breadcrumb-item\" data-action=\"finder:goRoot\">${viewLabel}</button>`\r\n        );\r\n        this.currentPath.forEach((part, index) => {\r\n            if (index === 0 && this.currentView === 'computer' && part === ROOT_FOLDER_NAME) return;\r\n            const pathUpToHere = this.currentPath.slice(0, index + 1);\r\n            parts.push('<span class=\"finder-breadcrumb-separator\">›</span>');\r\n            parts.push(\r\n                `<button class=\"finder-breadcrumb-item\" data-action=\"finder:navigateToPath\" data-path=\"${pathUpToHere.join('/')}\">${part}</button>`\r\n            );\r\n        });\r\n        this.domRefs.breadcrumbs.innerHTML = parts.join('');\r\n    }\r\n\r\n    renderContent() {\r\n        if (!this.domRefs.contentArea) return;\r\n        if (this.currentView === 'github') {\r\n            this.renderGithubContent();\r\n            return;\r\n        }\r\n        const items = this.getCurrentItems();\r\n        if (items.length === 0) {\r\n            let emptyText = 'Dieser Ordner ist leer';\r\n            try {\r\n                const lang = (\r\n                    window.appI18n?.getActiveLanguage?.() ||\r\n                    document.documentElement?.lang ||\r\n                    'de'\r\n                ).toLowerCase();\r\n                emptyText = lang.startsWith('de')\r\n                    ? 'Dieser Ordner ist leer'\r\n                    : 'This folder is empty';\r\n            } catch {}\r\n            this.domRefs.contentArea.innerHTML = `<div class=\"finder-empty-state\"><div class=\"text-6xl mb-4\">📂</div><div class=\"text-gray-500 dark:text-gray-400\">${emptyText}</div></div>`;\r\n            return;\r\n        }\r\n        const sortedItems = this.sortItems(items);\r\n        switch (this.viewMode) {\r\n            case 'list':\r\n                this.renderListView(sortedItems);\r\n                break;\r\n            case 'grid':\r\n                this.renderGridView(sortedItems);\r\n                break;\r\n            case 'columns':\r\n                this.renderListView(sortedItems);\r\n                break;\r\n        }\r\n    }\r\n\r\n    getCurrentItems(): FileItem[] {\r\n        switch (this.currentView) {\r\n            case 'computer':\r\n                return this.getComputerItems();\r\n            case 'github':\r\n                return this.getGithubItems();\r\n            case 'favorites':\r\n                return this.getFavoriteItems();\r\n            case 'recent':\r\n                return this.getRecentItems();\r\n            default:\r\n                return [];\r\n        }\r\n    }\r\n\r\n    getComputerItems(): FileItem[] {\r\n        let current: any = this.virtualFileSystem;\r\n        for (const pathPart of this.currentPath) {\r\n            if (current[pathPart] && current[pathPart].children)\r\n                current = current[pathPart].children;\r\n            else return [];\r\n        }\r\n        return Object.entries(current).map(([name, item]: [string, any]) => ({\r\n            name,\r\n            type: item.type,\r\n            icon: item.icon || (item.type === 'folder' ? '📁' : '📄'),\r\n            size: item.size || 0,\r\n            modified: item.modified || new Date().toISOString(),\r\n        }));\r\n    }\r\n\r\n    getGithubItems(): FileItem[] {\r\n        return [];\r\n    }\r\n\r\n    getFavoriteItems(): FileItem[] {\r\n        return Array.from(this.favorites).map(path => ({\r\n            name: path.split('/').pop() || path,\r\n            type: 'favorite',\r\n            icon: '⭐',\r\n            path,\r\n        }));\r\n    }\r\n\r\n    getRecentItems(): FileItem[] {\r\n        return this.recentFiles.map(file => ({\r\n            name: file.name,\r\n            type: 'recent',\r\n            icon: file.icon || '📄',\r\n            path: file.path,\r\n            modified: file.modified,\r\n        }));\r\n    }\r\n\r\n    sortItems(items: FileItem[]): FileItem[] {\r\n        const sorted = [...items];\r\n        sorted.sort((a, b) => {\r\n            if (a.type === 'folder' && b.type !== 'folder') return -1;\r\n            if (a.type !== 'folder' && b.type === 'folder') return 1;\r\n            let comparison = 0;\r\n            switch (this.sortBy) {\r\n                case 'name':\r\n                    comparison = a.name.localeCompare(b.name);\r\n                    break;\r\n                case 'size':\r\n                    comparison = (a.size || 0) - (b.size || 0);\r\n                    break;\r\n                case 'date': {\r\n                    const aTime = a.modified ? Date.parse(a.modified) : 0;\r\n                    const bTime = b.modified ? Date.parse(b.modified) : 0;\r\n                    comparison = bTime - aTime;\r\n                    break;\r\n                }\r\n                case 'type':\r\n                    comparison = (a.type || '').localeCompare(b.type || '');\r\n                    break;\r\n            }\r\n            return this.sortOrder === 'asc' ? comparison : -comparison;\r\n        });\r\n        return sorted;\r\n    }\r\n\r\n    renderListView(items: FileItem[]) {\r\n        this._renderedItems = items;\r\n        const rows = items\r\n            .map((item, i) => {\r\n                const isSelected = this.selectedItems.has(item.name);\r\n                const selectedCls = isSelected ? 'bg-blue-100 dark:bg-blue-900' : '';\r\n                return `\r\n                <tr class=\"finder-list-item ${selectedCls}\" data-index=\"${i}\" data-action-dblclick=\"finder:openItem\" data-item-name=\"${item.name}\" data-item-type=\"${item.type}\">\r\n                    <td><span class=\"finder-item-icon\">${item.icon || ''}</span><span class=\"finder-item-name\">${item.name}</span></td>\r\n                    <td>${this.formatSize(item.size)}</td>\r\n                    <td>${this.formatDate(item.modified)}</td>\r\n                </tr>`;\r\n            })\r\n            .join('');\r\n        this.domRefs.contentArea!.innerHTML = `\r\n                        <div id=\"finder-list-container\">\r\n                            <table class=\"finder-list-table\">\r\n                <thead>\r\n                  <tr>\r\n                    <th data-action=\"finder:setSortBy\" data-sort-by=\"name\">Name</th>\r\n                    <th data-action=\"finder:setSortBy\" data-sort-by=\"size\">Größe</th>\r\n                    <th data-action=\"finder:setSortBy\" data-sort-by=\"date\">Geändert</th>\r\n                  </tr>\r\n                </thead>\r\n                                <tbody>${rows}</tbody>\r\n                            </table>\r\n                            <div id=\"finder-empty-spacer\" style=\"height: 32px;\"></div>\r\n            </div>`;\r\n    }\r\n\r\n    renderGridView(items: FileItem[]) {\r\n        this._renderedItems = items;\r\n        const tiles = items\r\n            .map((item, i) => {\r\n                const isSelected = this.selectedItems.has(item.name);\r\n                const selectedCls = isSelected\r\n                    ? 'ring-2 ring-blue-500 ring-offset-2 dark:ring-offset-gray-900 bg-blue-100/60 dark:bg-blue-900/40'\r\n                    : '';\r\n                return `\r\n              <div class=\"finder-grid-item ${selectedCls}\" data-index=\"${i}\" data-action-dblclick=\"finder:openItem\" data-item-name=\"${item.name}\" data-item-type=\"${item.type}\">\r\n                <div class=\"finder-grid-icon\">${item.icon || ''}</div>\r\n                <div class=\"finder-grid-name\">${item.name}</div>\r\n              </div>`;\r\n            })\r\n            .join('');\r\n        this.domRefs.contentArea!.innerHTML = `\r\n                    <div id=\"finder-list-container\">\r\n                        <div class=\"finder-grid-container\">${tiles}</div>\r\n                        <div id=\"finder-empty-spacer\" style=\"height: 32px;\"></div>\r\n                    </div>`;\r\n    }\r\n\r\n    openItem(name: string, type: string) {\r\n        if (type === 'folder') {\r\n            this.navigateToFolder(name);\r\n        } else if (type === 'file') {\r\n            this.addToRecent(name);\r\n            (this as any).emit?.('fileOpened', {\r\n                name,\r\n                path: [...this.currentPath, name].join('/'),\r\n            });\r\n            if (this.currentView === 'github') {\r\n                const item = this.lastGithubItemsMap.get(name);\r\n                const isImage = /\\.(png|jpe?g|gif|bmp|webp|svg)$/i.test(name);\r\n                if (item && isImage && item.download_url) {\r\n                    this.openImageViewer({ src: item.download_url, name });\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    async renderGithubContent() {\r\n        const el = this.domRefs.contentArea;\r\n        if (!el) return;\r\n        if (this.currentPath.length === 0) {\r\n            el.innerHTML = '<div class=\"finder-empty-state\">Lade Repositories…</div>';\r\n            const repos = await this.fetchGithubRepos();\r\n            this.lastGithubItemsMap.clear();\r\n            const items = (repos || []).map((repo: any) => ({\r\n                name: repo.name,\r\n                type: 'folder',\r\n                icon: '📦',\r\n            }));\r\n            items.forEach((it: any) => this.lastGithubItemsMap.set(it.name, it));\r\n            if (this.githubError && items.length === 0) {\r\n                el.innerHTML =\r\n                    '<div class=\"finder-empty-state text-center\"><div class=\"text-2xl mb-2\">⚠️</div><div>Repositories could not be loaded (Repos konnten nicht geladen werden). Possible Rate Limit.</div></div>';\r\n            } else if (items.length === 0) {\r\n                el.innerHTML =\r\n                    '<div class=\"finder-empty-state text-center\">Keine öffentlichen Repositories gefunden</div>';\r\n            } else {\r\n                this.renderListView(items);\r\n            }\r\n            return;\r\n        }\r\n        const repo = this.currentPath[0];\r\n        if (!repo) {\r\n            return;\r\n        }\r\n        const subPathParts = this.currentPath.slice(1);\r\n        const subPath = subPathParts.join('/');\r\n        el.innerHTML = '<div class=\"finder-empty-state\">Lade Inhalte…</div>';\r\n        const contents = await this.fetchGithubContents(repo, subPath);\r\n        this.lastGithubItemsMap.clear();\r\n        const items = (contents || []).map((entry: any) => {\r\n            const isDir = entry.type === 'dir';\r\n            return {\r\n                name: entry.name,\r\n                type: isDir ? 'folder' : 'file',\r\n                icon: isDir ? '📁' : '📄',\r\n                size: entry.size || 0,\r\n                download_url: entry.download_url || null,\r\n            } as FileItem;\r\n        });\r\n        items.forEach((it: any) => this.lastGithubItemsMap.set(it.name, it));\r\n        if (this.githubError && items.length === 0) {\r\n            el.innerHTML =\r\n                '<div class=\"finder-empty-state text-center\"><div class=\"text-2xl mb-2\">⚠️</div><div>Repositories could not be loaded (Repos konnten nicht geladen werden). Possible Rate Limit.</div></div>';\r\n        } else if (items.length === 0) {\r\n            el.innerHTML =\r\n                '<div class=\"finder-empty-state text-center\">Dieser Ordner ist leer</div>';\r\n        } else {\r\n            this.renderListView(items);\r\n        }\r\n    }\r\n\r\n    async fetchGithubRepos() {\r\n        const GITHUB_USERNAME = 'Marormur';\r\n        try {\r\n            if (Array.isArray(this.githubRepos) && this.githubRepos.length) return this.githubRepos;\r\n            const res = await fetch(`https://api.github.com/users/${GITHUB_USERNAME}/repos`, {\r\n                headers: { Accept: 'application/vnd.github.v3+json' },\r\n            });\r\n            if (!res.ok) throw new Error('GitHub repos fetch failed');\r\n            const data = await res.json();\r\n            this.githubRepos = data || [];\r\n            this.githubError = false;\r\n            this.githubErrorMessage = '';\r\n            return this.githubRepos;\r\n        } catch (e) {\r\n            console.warn('GitHub repos error:', e);\r\n            this.githubError = true;\r\n            this.githubErrorMessage = 'Repositories could not be loaded';\r\n            return [];\r\n        }\r\n    }\r\n\r\n    async fetchGithubContents(repo: string, subPath = '') {\r\n        try {\r\n            const key = `${repo}:${subPath}`;\r\n            if (this.githubContentCache.has(key)) return this.githubContentCache.get(key);\r\n            const base = `https://api.github.com/repos/Marormur/${repo}/contents`;\r\n            const url = subPath ? `${base}/${this._encodeGithubPath(subPath)}` : base;\r\n            const res = await fetch(url, { headers: { Accept: 'application/vnd.github.v3+json' } });\r\n            if (!res.ok) throw new Error('GitHub contents fetch failed');\r\n            const data = await res.json();\r\n            this.githubContentCache.set(key, data || []);\r\n            this.githubError = false;\r\n            this.githubErrorMessage = '';\r\n            return data;\r\n        } catch (e) {\r\n            console.warn('GitHub contents error:', e);\r\n            this.githubError = true;\r\n            this.githubErrorMessage = 'Repositories could not be loaded';\r\n            return [];\r\n        }\r\n    }\r\n\r\n    private _encodeGithubPath(subPath: string) {\r\n        if (!subPath) return '';\r\n        return subPath\r\n            .split('/')\r\n            .filter(Boolean)\r\n            .map(seg => encodeURIComponent(seg))\r\n            .join('/');\r\n    }\r\n\r\n    openImageViewer({ src, name }: { src: string; name: string }) {\r\n        try {\r\n            const img = document.getElementById('image-viewer') as HTMLImageElement | null;\r\n            const info = document.getElementById('image-info');\r\n            const placeholder = document.getElementById('image-placeholder');\r\n            if (info) {\r\n                info.textContent = name || '';\r\n                info.classList.remove('hidden');\r\n            }\r\n            if (placeholder) placeholder.classList.add('hidden');\r\n            if (img) {\r\n                img.src = src;\r\n                img.classList.remove('hidden');\r\n            }\r\n            if (window.PhotosApp && typeof window.PhotosApp.showExternalImage === 'function') {\r\n                window.PhotosApp.showExternalImage({ src, name });\r\n            }\r\n            if (window.API?.window?.open) {\r\n                window.API.window.open('image-modal');\r\n            } else {\r\n                const modal = document.getElementById('image-modal');\r\n                if (modal) modal.classList.remove('hidden');\r\n            }\r\n        } catch (e) {\r\n            console.warn('Failed to open image viewer:', e);\r\n        }\r\n    }\r\n\r\n    addToRecent(name: string) {\r\n        const fullPath = [...this.currentPath, name].join('/');\r\n        this.recentFiles.unshift({\r\n            name,\r\n            path: fullPath,\r\n            icon: '📄',\r\n            modified: new Date().toISOString(),\r\n        });\r\n        this.recentFiles = this.recentFiles.slice(0, 20);\r\n        (this as any).updateState?.({ recentFiles: this.recentFiles });\r\n    }\r\n\r\n    setSortBy(field: FinderState['sortBy']) {\r\n        if (this.sortBy === field) this.sortOrder = this.sortOrder === 'asc' ? 'desc' : 'asc';\r\n        else {\r\n            this.sortBy = field;\r\n            this.sortOrder = 'asc';\r\n        }\r\n        this.renderContent();\r\n        (this as any).updateState?.({ sortBy: this.sortBy, sortOrder: this.sortOrder });\r\n    }\r\n\r\n    setViewMode(mode: ViewMode) {\r\n        this.viewMode = mode;\r\n        this.renderContent();\r\n        (this as any).updateState?.({ viewMode: this.viewMode });\r\n    }\r\n\r\n    formatSize(bytes?: number) {\r\n        if (!bytes || bytes === 0) return '-';\r\n        if (bytes < 1024) return bytes + ' B';\r\n        if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(1) + ' KB';\r\n        return (bytes / (1024 * 1024)).toFixed(1) + ' MB';\r\n    }\r\n\r\n    formatDate(dateStr?: string) {\r\n        if (!dateStr) return '-';\r\n        const date = new Date(dateStr);\r\n        return date.toLocaleDateString('de-DE', {\r\n            day: '2-digit',\r\n            month: '2-digit',\r\n            year: 'numeric',\r\n        });\r\n    }\r\n\r\n    serialize() {\r\n        return {\r\n            ...(super.serialize?.() || {}),\r\n            currentPath: this.currentPath,\r\n            currentView: this.currentView,\r\n            viewMode: this.viewMode,\r\n            sortBy: this.sortBy,\r\n            sortOrder: this.sortOrder,\r\n            favorites: Array.from(this.favorites),\r\n            recentFiles: this.recentFiles,\r\n        };\r\n    }\r\n\r\n    deserialize(data: any) {\r\n        (this as any)._skipInitialRender = true;\r\n        super.deserialize?.(data);\r\n        if (data.currentPath) this.currentPath = data.currentPath;\r\n        if (data.currentView) this.currentView = data.currentView;\r\n        if (data.viewMode) this.viewMode = data.viewMode;\r\n        if (data.sortBy) this.sortBy = data.sortBy;\r\n        if (data.sortOrder) this.sortOrder = data.sortOrder;\r\n        if (data.favorites) this.favorites = new Set(data.favorites);\r\n        if (data.recentFiles) this.recentFiles = data.recentFiles;\r\n        this.navigateTo(this.currentPath, this.currentView);\r\n    }\r\n\r\n    focus() {\r\n        super.focus?.();\r\n        // Do not autofocus search input automatically\r\n    }\r\n}\r\n\r\n// Expose on window for compatibility with the integration layer\r\nwindow.FinderInstance = FinderInstance as any;\r\n\r\nif (window.InstanceManager) {\r\n    window.FinderInstanceManager = new window.InstanceManager({\r\n        type: 'finder',\r\n        instanceClass: FinderInstance,\r\n        maxInstances: 0,\r\n        createContainer: function (instanceId: string): HTMLElement {\r\n            const finderModalContainer = document.getElementById('finder-container');\r\n            const container = document.createElement('div');\r\n            container.id = `${instanceId}-container`;\r\n            container.className =\r\n                'finder-instance-container h-full flex-1 w-full min-w-0 flex flex-col min-h-0';\r\n            container.classList.add('hidden');\r\n            if (finderModalContainer) {\r\n                finderModalContainer.appendChild(container);\r\n            } else {\r\n                console.error('Finder container not found; using document.body as fallback');\r\n                document.body.appendChild(container);\r\n            }\r\n            return container;\r\n        },\r\n    });\r\n}\r\n\r\nexport {};\r\n"]}