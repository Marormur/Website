{"version":3,"file":"base-window-instance.js","sourceRoot":"","sources":["../src/ts/base-window-instance.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * src/ts/base-window-instance.ts\n * Typed port of js/base-window-instance.js\n */\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\nimport { triggerAutoSave } from './utils/auto-save-helper.js';\n\nexport type EventCallback = (data?: any) => void;\n\nexport interface BaseWindowConfig {\n    id?: string;\n    type?: string;\n    title?: string;\n    initialState?: Record<string, any>;\n    metadata?: Record<string, any>;\n}\n\nexport class BaseWindowInstance {\n    instanceId: string;\n    type: string;\n    title: string;\n    container: HTMLElement | null;\n    windowElement: HTMLElement | null;\n    state: Record<string, any>;\n    eventListeners: Map<string, EventCallback[]>;\n    isInitialized: boolean;\n    isVisible: boolean;\n    metadata: Record<string, any>;\n\n    constructor(config: BaseWindowConfig) {\n        this.instanceId = config.id || this._generateId();\n        this.type = config.type || 'unknown';\n        this.title = config.title || 'Untitled';\n        this.container = null;\n        this.windowElement = null;\n        this.state = this._initializeState(config.initialState || {});\n        this.eventListeners = new Map();\n        this.isInitialized = false;\n        this.isVisible = false;\n        this.metadata = config.metadata || {};\n    }\n\n    private _generateId(): string {\n        return `${this.type}-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\n    }\n\n    private _initializeState(initialState: Record<string, any>): Record<string, any> {\n        return {\n            ...initialState,\n            created: Date.now(),\n            modified: Date.now(),\n        };\n    }\n\n    init(container: HTMLElement) {\n        if (this.isInitialized) {\n            console.warn(`Instance ${this.instanceId} already initialized`);\n            return;\n        }\n        this.container = container;\n        this.render();\n        this.attachEventListeners();\n        this.isInitialized = true;\n        this.emit('initialized');\n    }\n\n    // Subclasses must implement render\n    render(): void {\n        throw new Error('render() must be implemented by subclass');\n    }\n\n    attachEventListeners(): void {\n        // optional override by subclasses\n    }\n\n    show(): void {\n        if (this.container) {\n            this.container.classList.remove('hidden');\n            this.isVisible = true;\n            this.emit('shown');\n        }\n    }\n\n    hide(): void {\n        if (this.container) {\n            this.container.classList.add('hidden');\n            this.isVisible = false;\n            this.emit('hidden');\n        }\n    }\n\n    destroy(): void {\n        this.emit('beforeDestroy');\n        this.removeAllEventListeners();\n        if (this.container) {\n            try {\n                if (typeof (this.container as any).remove === 'function') {\n                    (this.container as any).remove();\n                } else if (this.container.parentNode) {\n                    this.container.parentNode.removeChild(this.container);\n                }\n            } catch {\n                try {\n                    this.container.innerHTML = '';\n                    this.container.classList.add('hidden');\n                } catch {\n                    /* ignore */\n                }\n            }\n            this.container = null;\n        }\n        this.windowElement = null;\n        this.isInitialized = false;\n        this.emit('destroyed');\n    }\n\n    updateState(updates: Record<string, any>): void {\n        const oldState = { ...this.state };\n        this.state = {\n            ...this.state,\n            ...updates,\n            modified: Date.now(),\n        };\n        this.emit('stateChanged', { oldState, newState: this.state });\n        \n        // Trigger auto-save when state changes\n        this._triggerAutoSave();\n    }\n    \n    private _triggerAutoSave(): void {\n        const w = window as any;\n        if (w.SessionManager && typeof w.SessionManager.saveInstanceType === 'function') {\n            try {\n                w.SessionManager.saveInstanceType(this.type);\n            } catch (error) {\n                console.warn('Failed to trigger auto-save:', error);\n            }\n        }\n    }\n\n    getState(): Record<string, any> {\n        return { ...this.state };\n    }\n\n    serialize() {\n        return {\n            instanceId: this.instanceId,\n            type: this.type,\n            title: this.title,\n            state: this.getState(),\n            metadata: this.metadata,\n        };\n    }\n\n    deserialize(data: any) {\n        if (data.state) this.state = data.state;\n        if (data.title) this.title = data.title;\n        if (data.metadata) this.metadata = { ...this.metadata, ...data.metadata };\n        this.emit('deserialized');\n    }\n\n    emit(eventName: string, data?: any): void {\n        const listeners = this.eventListeners.get(eventName) || [];\n        listeners.forEach(callback => {\n            try {\n                callback.call(this, data);\n            } catch (error) {\n                console.error(`Error in event listener for ${eventName}:`, error);\n            }\n        });\n    }\n\n    on(eventName: string, callback: EventCallback): void {\n        if (!this.eventListeners.has(eventName)) this.eventListeners.set(eventName, []);\n        this.eventListeners.get(eventName)!.push(callback);\n    }\n\n    off(eventName: string, callback: EventCallback): void {\n        if (!this.eventListeners.has(eventName)) return;\n        const listeners = this.eventListeners.get(eventName)!;\n        const index = listeners.indexOf(callback);\n        if (index > -1) listeners.splice(index, 1);\n    }\n\n    removeAllEventListeners(): void {\n        this.eventListeners.clear();\n    }\n\n    focus(): void {\n        if (this.container && this.isVisible) this.emit('focused');\n    }\n\n    blur(): void {\n        this.emit('blurred');\n    }\n}\n\n// Attach to window for legacy compatibility\n// Note: Type declaration is in types/index.d.ts\nif (typeof window !== 'undefined') {\n    (window as any).BaseWindowInstance = BaseWindowInstance;\n}\n\nexport default BaseWindowInstance;\nconsole.log('BaseWindowInstance loaded');\n\n(function () {\n    'use strict';\n\n    type InstanceConfig = {\n        id?: string;\n        type?: string;\n        title?: string;\n        initialState?: Record<string, unknown>;\n        metadata?: Record<string, unknown>;\n    };\n\n    type StateChangeEvent = {\n        oldState: Record<string, unknown>;\n        newState: Record<string, unknown>;\n    };\n\n    type SerializedInstance = {\n        instanceId: string;\n        type: string;\n        title: string;\n        state: Record<string, unknown>;\n        metadata: Record<string, unknown>;\n    };\n\n    type EventCallback = (data?: unknown) => void;\n\n    class BaseWindowInstance {\n        instanceId: string;\n        type: string;\n        title: string;\n        container: HTMLElement | null;\n        windowElement: HTMLElement | null;\n        state: Record<string, unknown>;\n        eventListeners: Map<string, EventCallback[]>;\n        isInitialized: boolean;\n        isVisible: boolean;\n        metadata: Record<string, unknown>;\n\n        constructor(config: InstanceConfig) {\n            this.instanceId = config.id || this._generateId();\n            this.type = config.type || 'unknown';\n            this.title = config.title || 'Untitled';\n            this.container = null;\n            this.windowElement = null;\n            this.state = this._initializeState(config.initialState || {});\n            this.eventListeners = new Map();\n            this.isInitialized = false;\n            this.isVisible = false;\n            this.metadata = config.metadata || {};\n        }\n\n        protected _generateId(): string {\n            return `${this.type}-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\n        }\n\n        protected _initializeState(initialState: Record<string, unknown>): Record<string, unknown> {\n            return {\n                ...initialState,\n                created: Date.now(),\n                modified: Date.now(),\n            };\n        }\n\n        init(container: HTMLElement): void {\n            if (this.isInitialized) {\n                console.warn(`Instance ${this.instanceId} already initialized`);\n                return;\n            }\n\n            this.container = container;\n            this.render();\n            this.attachEventListeners();\n            this.isInitialized = true;\n            this.emit('initialized');\n        }\n\n        protected render(): void {\n            throw new Error('render() must be implemented by subclass');\n        }\n\n        protected attachEventListeners(): void {\n            // To be implemented by subclasses\n        }\n\n        show(): void {\n            if (this.container) {\n                this.container.classList.remove('hidden');\n                this.isVisible = true;\n                this.emit('shown');\n            }\n        }\n\n        hide(): void {\n            if (this.container) {\n                this.container.classList.add('hidden');\n                this.isVisible = false;\n                this.emit('hidden');\n            }\n        }\n\n        destroy(): void {\n            this.emit('beforeDestroy');\n            this.removeAllEventListeners();\n\n            if (this.container) {\n                try {\n                    // Remove container element from DOM to avoid orphaned visible nodes\n                    if (typeof (this.container as HTMLElement).remove === 'function') {\n                        (this.container as HTMLElement).remove();\n                    } else if ((this.container as HTMLElement).parentNode) {\n                        (this.container as HTMLElement).parentNode!.removeChild(\n                            this.container as HTMLElement\n                        );\n                    }\n                } catch {\n                    // Fallback: clear contents and hide\n                    try {\n                        this.container.innerHTML = '';\n                        this.container.classList.add('hidden');\n                    } catch {\n                        /* ignore */\n                    }\n                }\n                this.container = null;\n            }\n\n            this.windowElement = null;\n            this.isInitialized = false;\n            this.emit('destroyed');\n        }\n\n        updateState(updates: Record<string, unknown>): void {\n            const oldState = { ...this.state };\n            this.state = {\n                ...this.state,\n                ...updates,\n                modified: Date.now(),\n            };\n            this.emit('stateChanged', { oldState, newState: this.state } as StateChangeEvent);\n            \n            // Trigger auto-save when state changes\n            this._triggerAutoSave();\n        }\n        \n        private _triggerAutoSave(): void {\n            triggerAutoSave(this.type);\n        }\n\n        getState(): Record<string, unknown> {\n            return { ...this.state };\n        }\n\n        serialize(): SerializedInstance {\n            return {\n                instanceId: this.instanceId,\n                type: this.type,\n                title: this.title,\n                state: this.getState(),\n                metadata: this.metadata,\n            };\n        }\n\n        deserialize(data: Partial<SerializedInstance>): void {\n            if (data.state) {\n                this.state = data.state;\n            }\n            if (data.title) {\n                this.title = data.title;\n            }\n            if (data.metadata) {\n                this.metadata = { ...this.metadata, ...data.metadata };\n            }\n            this.emit('deserialized');\n        }\n\n        emit(eventName: string, data?: unknown): void {\n            const listeners = this.eventListeners.get(eventName) || [];\n            listeners.forEach(callback => {\n                try {\n                    callback.call(this, data);\n                } catch (error) {\n                    console.error(`Error in event listener for ${eventName}:`, error);\n                }\n            });\n        }\n\n        on(eventName: string, callback: EventCallback): void {\n            if (!this.eventListeners.has(eventName)) {\n                this.eventListeners.set(eventName, []);\n            }\n            this.eventListeners.get(eventName)!.push(callback);\n        }\n\n        off(eventName: string, callback: EventCallback): void {\n            if (!this.eventListeners.has(eventName)) return;\n\n            const listeners = this.eventListeners.get(eventName)!;\n            const index = listeners.indexOf(callback);\n            if (index > -1) {\n                listeners.splice(index, 1);\n            }\n        }\n\n        removeAllEventListeners(): void {\n            this.eventListeners.clear();\n        }\n\n        focus(): void {\n            if (this.container && this.isVisible) {\n                this.emit('focused');\n            }\n        }\n\n        blur(): void {\n            this.emit('blurred');\n        }\n    }\n\n    (window as unknown as { BaseWindowInstance: typeof BaseWindowInstance }).BaseWindowInstance =\n        BaseWindowInstance;\n})();\n"]}