{"version":3,"file":"base-tab.js","sourceRoot":"","sources":["../src/ts/base-tab.ts"],"names":[],"mappings":";AAAA;;;;GAIG;AACH,uDAAuD;;;AAuBvD;;;;;;;;;;;;;;;;;GAiBG;AACH,MAAa,OAAO;IAWhB,YAAY,MAAiB;QACzB,IAAI,CAAC,EAAE,GAAG,MAAM,CAAC,EAAE,IAAI,IAAI,CAAC,WAAW,EAAE,CAAC;QAC1C,IAAI,CAAC,IAAI,GAAG,MAAM,CAAC,IAAI,CAAC;QACxB,IAAI,CAAC,KAAK,GAAG,MAAM,CAAC,KAAK,IAAI,UAAU,CAAC;QACxC,IAAI,CAAC,IAAI,GAAG,MAAM,CAAC,IAAI,CAAC;QACxB,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC;QACzB,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;QACpB,IAAI,CAAC,YAAY,GAAG,MAAM,CAAC,OAAO,IAAI,EAAE,CAAC;QACzC,IAAI,CAAC,QAAQ,GAAG,MAAM,CAAC,QAAQ,IAAI;YAC/B,OAAO,EAAE,IAAI,CAAC,GAAG,EAAE;YACnB,QAAQ,EAAE,IAAI,CAAC,GAAG,EAAE;SACvB,CAAC;QACF,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC;IAC3B,CAAC;IAEO,WAAW;QACf,OAAO,OAAO,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,GAAG,EAAE,IAAI,IAAI,CAAC,MAAM,EAAE,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC;IACvF,CAAC;IAED;;OAEG;IACH,eAAe,CAAC,MAAkB;QAC9B,IAAI,CAAC,YAAY,GAAG,MAAM,CAAC;IAC/B,CAAC;IAED;;;OAGG;IACH,SAAS;QACL,MAAM,SAAS,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;QAChD,SAAS,CAAC,EAAE,GAAG,GAAG,IAAI,CAAC,EAAE,YAAY,CAAC;QACtC,SAAS,CAAC,SAAS,GAAG,kCAAkC,CAAC;QACzD,SAAS,CAAC,WAAW,GAAG,mBAAmB,IAAI,CAAC,KAAK,EAAE,CAAC;QACxD,IAAI,CAAC,OAAO,GAAG,SAAS,CAAC;QACzB,OAAO,SAAS,CAAC;IACrB,CAAC;IAED;;OAEG;IACH,MAAM;QACF,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,CAAC;YAChB,IAAI,CAAC,SAAS,EAAE,CAAC;QACrB,CAAC;IACL,CAAC;IAED;;OAEG;IACH,IAAI;QACA,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,CAAC;YAChB,IAAI,CAAC,MAAM,EAAE,CAAC;YAEd,sCAAsC;YACtC,IAAI,IAAI,CAAC,YAAY,EAAE,cAAc,EAAE,CAAC;gBACpC,IAAI,CAAC,YAAY,CAAC,cAAc,CAAC,WAAW,CAAC,IAAI,CAAC,OAAQ,CAAC,CAAC;YAChE,CAAC;QACL,CAAC;QAED,IAAI,CAAC,OAAO,EAAE,SAAS,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;QACzC,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;QACtB,IAAI,CAAC,MAAM,EAAE,CAAC;IAClB,CAAC;IAED;;OAEG;IACH,IAAI;QACA,IAAI,CAAC,OAAO,EAAE,SAAS,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;QACtC,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC;QACvB,IAAI,CAAC,MAAM,EAAE,CAAC;IAClB,CAAC;IAED;;OAEG;IACO,MAAM;QACZ,0BAA0B;IAC9B,CAAC;IAED;;OAEG;IACO,MAAM;QACZ,0BAA0B;IAC9B,CAAC;IAED;;OAEG;IACH,QAAQ,CAAC,KAAa;QAClB,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;QACnB,IAAI,CAAC,QAAQ,CAAC,QAAQ,GAAG,IAAI,CAAC,GAAG,EAAE,CAAC;QAEpC,yCAAyC;QACzC,IAAI,IAAI,CAAC,YAAY,EAAE,CAAC;YACnB,IAAI,CAAC,YAAoB,CAAC,WAAW,EAAE,EAAE,CAAC;QAC/C,CAAC;IACL,CAAC;IAED;;OAEG;IACH,kBAAkB,CAAC,OAAY;QAC3B,IAAI,CAAC,YAAY,GAAG;YAChB,GAAG,IAAI,CAAC,YAAY;YACpB,GAAG,OAAO;SACb,CAAC;QACF,IAAI,CAAC,QAAQ,CAAC,QAAQ,GAAG,IAAI,CAAC,GAAG,EAAE,CAAC;QACpC,IAAI,CAAC,UAAU,EAAE,CAAC;IACtB,CAAC;IAED;;OAEG;IACH,SAAS;QACL,OAAO;YACH,EAAE,EAAE,IAAI,CAAC,EAAE;YACX,IAAI,EAAE,IAAI,CAAC,IAAI;YACf,KAAK,EAAE,IAAI,CAAC,KAAK;YACjB,IAAI,EAAE,IAAI,CAAC,IAAI;YACf,YAAY,EAAE,IAAI,CAAC,YAAY;YAC/B,OAAO,EAAE,IAAI,CAAC,QAAQ,CAAC,OAAO;YAC9B,QAAQ,EAAE,IAAI,CAAC,QAAQ,CAAC,QAAQ,IAAI,IAAI,CAAC,GAAG,EAAE;SACjD,CAAC;IACN,CAAC;IAED;;;OAGG;IACH,MAAM,CAAC,WAAW,CAAC,KAAe;QAC9B,OAAO,IAAI,OAAO,CAAC;YACf,EAAE,EAAE,KAAK,CAAC,EAAE;YACZ,IAAI,EAAE,KAAK,CAAC,IAAI;YAChB,KAAK,EAAE,KAAK,CAAC,KAAK;YAClB,IAAI,EAAE,KAAK,CAAC,IAAI;YAChB,OAAO,EAAE,KAAK,CAAC,YAAY;YAC3B,QAAQ,EAAE;gBACN,OAAO,EAAE,KAAK,CAAC,OAAO;gBACtB,QAAQ,EAAE,KAAK,CAAC,QAAQ;aAC3B;SACJ,CAAC,CAAC;IACP,CAAC;IAEO,UAAU;QACd,qDAAqD;QACrD,IAAI,IAAI,CAAC,YAAY,EAAE,CAAC;YACpB,oEAAoE;YACnE,IAAI,CAAC,YAAoB,CAAC,UAAU,EAAE,EAAE,CAAC;QAC9C,CAAC;IACL,CAAC;IAED;;OAEG;IACH,UAAU,CAAC,YAAwB;QAC/B,IAAI,CAAC,IAAI,CAAC,YAAY,IAAI,IAAI,CAAC,YAAY,KAAK,YAAY;YAAE,OAAO;QAErE,6BAA6B;QAC7B,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;QAErC,uBAAuB;QACvB,YAAY,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;IAC9B,CAAC;IAED;;OAEG;IACH,OAAO;QACH,IAAI,IAAI,CAAC,OAAO,EAAE,CAAC;YACf,IAAI,CAAC,OAAO,CAAC,MAAM,EAAE,CAAC;YACtB,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;QACxB,CAAC;QAED,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC;QACzB,IAAI,CAAC,UAAU,EAAE,CAAC;IACtB,CAAC;CACJ;AA/LD,0BA+LC;AAED,qCAAqC;AACpC,MAAc,CAAC,OAAO,GAAG,OAAO,CAAC","sourcesContent":["/**\r\n * src/ts/base-tab.ts\r\n * Base class for tabs within a window\r\n * Each tab represents a content instance (Terminal Session, Document, etc.)\r\n */\r\n/* eslint-disable @typescript-eslint/no-explicit-any */\r\n\r\nimport type { BaseWindow } from './base-window.js';\r\n\r\nexport interface TabConfig {\r\n    id?: string;\r\n    type: string;\r\n    title?: string;\r\n    icon?: string;\r\n    content?: any;\r\n    metadata?: Record<string, any>;\r\n}\r\n\r\nexport interface TabState {\r\n    id: string;\r\n    type: string;\r\n    title: string;\r\n    icon?: string;\r\n    contentState: any;\r\n    created: number;\r\n    modified: number;\r\n}\r\n\r\n/**\r\n * BaseTab – Basisklasse für Inhalte innerhalb eines Fensters\r\n *\r\n * Architektur\r\n * -----------\r\n * - Ein Tab gehört immer genau einem Fenster (parentWindow) – kann aber via\r\n *   Drag&Drop in ein anderes Fenster verschoben werden.\r\n * - Der Inhalt (createDOM/render) ist unabhängig vom Fenstercontainer.\r\n * - Relevanter Zustand wird in contentState gehalten und bei Änderungen\r\n *   gespeichert (_saveState), damit Session‑Restore funktioniert.\r\n *\r\n * Erweiterung\r\n * -----------\r\n * - Subklassen MÜSSEN createDOM() überschreiben und können onShow/onHide\r\n *   nutzen.\r\n * - setTitle() benachrichtigt das Elternfenster zur Aktualisierung der Tabbar\r\n *   (z. B. wenn sich der Ordnername im Finder ändert).\r\n */\r\nexport class BaseTab {\r\n    id: string;\r\n    type: string;\r\n    title: string;\r\n    icon?: string;\r\n    parentWindow: BaseWindow | null;\r\n    element: HTMLElement | null;\r\n    contentState: any;\r\n    metadata: Record<string, any>;\r\n    isVisible: boolean;\r\n\r\n    constructor(config: TabConfig) {\r\n        this.id = config.id || this._generateId();\r\n        this.type = config.type;\r\n        this.title = config.title || 'Untitled';\r\n        this.icon = config.icon;\r\n        this.parentWindow = null;\r\n        this.element = null;\r\n        this.contentState = config.content || {};\r\n        this.metadata = config.metadata || {\r\n            created: Date.now(),\r\n            modified: Date.now(),\r\n        };\r\n        this.isVisible = false;\r\n    }\r\n\r\n    private _generateId(): string {\r\n        return `tab-${this.type}-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\r\n    }\r\n\r\n    /**\r\n     * Set parent window (called when tab is added to a window)\r\n     */\r\n    setParentWindow(window: BaseWindow): void {\r\n        this.parentWindow = window;\r\n    }\r\n\r\n    /**\r\n     * Erstellt das DOM des Tabs. Subklassen MÜSSEN überschreiben. Der Default\r\n     * liefert nur einen Platzhalter.\r\n     */\r\n    createDOM(): HTMLElement {\r\n        const container = document.createElement('div');\r\n        container.id = `${this.id}-container`;\r\n        container.className = 'tab-content hidden w-full h-full';\r\n        container.textContent = `Tab content for ${this.title}`;\r\n        this.element = container;\r\n        return container;\r\n    }\r\n\r\n    /**\r\n     * Rendering-Hook. Subklassen implementieren hier die eigentliche UI.\r\n     */\r\n    render(): void {\r\n        if (!this.element) {\r\n            this.createDOM();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Tab sichtbar machen und ggf. in die Content‑Area des Elternfensters einhängen.\r\n     */\r\n    show(): void {\r\n        if (!this.element) {\r\n            this.render();\r\n\r\n            // Add to parent window's content area\r\n            if (this.parentWindow?.contentElement) {\r\n                this.parentWindow.contentElement.appendChild(this.element!);\r\n            }\r\n        }\r\n\r\n        this.element?.classList.remove('hidden');\r\n        this.isVisible = true;\r\n        this.onShow();\r\n    }\r\n\r\n    /**\r\n     * Tab verbergen (DOM bleibt erhalten, CSS .hidden).\r\n     */\r\n    hide(): void {\r\n        this.element?.classList.add('hidden');\r\n        this.isVisible = false;\r\n        this.onHide();\r\n    }\r\n\r\n    /**\r\n     * Lifecycle‑Hook beim Anzeigen.\r\n     */\r\n    protected onShow(): void {\r\n        // Subclasses can override\r\n    }\r\n\r\n    /**\r\n     * Lifecycle‑Hook beim Verbergen.\r\n     */\r\n    protected onHide(): void {\r\n        // Subclasses can override\r\n    }\r\n\r\n    /**\r\n     * Tabtitel aktualisieren und Parent zur Tabbar‑Re‑Render benachrichtigen.\r\n     */\r\n    setTitle(title: string): void {\r\n        this.title = title;\r\n        this.metadata.modified = Date.now();\r\n\r\n        // Notify parent window to re-render tabs\r\n        if (this.parentWindow) {\r\n            (this.parentWindow as any)._renderTabs?.();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Content‑State aktualisieren (z. B. Cursorposition, offene Datei, Sortierung,...)\r\n     */\r\n    updateContentState(updates: any): void {\r\n        this.contentState = {\r\n            ...this.contentState,\r\n            ...updates,\r\n        };\r\n        this.metadata.modified = Date.now();\r\n        this._saveState();\r\n    }\r\n\r\n    /**\r\n     * Serialize tab state for session management\r\n     */\r\n    serialize(): TabState {\r\n        return {\r\n            id: this.id,\r\n            type: this.type,\r\n            title: this.title,\r\n            icon: this.icon,\r\n            contentState: this.contentState,\r\n            created: this.metadata.created,\r\n            modified: this.metadata.modified || Date.now(),\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Rehydrierung – Subklassen überschreiben diese Methode meist, um ihren\r\n     * konkreten Zustand zurückzusetzen.\r\n     */\r\n    static deserialize(state: TabState): BaseTab {\r\n        return new BaseTab({\r\n            id: state.id,\r\n            type: state.type,\r\n            title: state.title,\r\n            icon: state.icon,\r\n            content: state.contentState,\r\n            metadata: {\r\n                created: state.created,\r\n                modified: state.modified,\r\n            },\r\n        });\r\n    }\r\n\r\n    private _saveState(): void {\r\n        // Save tab state via parent window's session manager\r\n        if (this.parentWindow) {\r\n            // Trigger parent window to save its state (which includes all tabs)\r\n            (this.parentWindow as any)._saveState?.();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Transfer tab to another window\r\n     */\r\n    transferTo(targetWindow: BaseWindow): void {\r\n        if (!this.parentWindow || this.parentWindow === targetWindow) return;\r\n\r\n        // Remove from current window\r\n        this.parentWindow.removeTab(this.id);\r\n\r\n        // Add to target window\r\n        targetWindow.addTab(this);\r\n    }\r\n\r\n    /**\r\n     * Destroy tab and cleanup\r\n     */\r\n    destroy(): void {\r\n        if (this.element) {\r\n            this.element.remove();\r\n            this.element = null;\r\n        }\r\n\r\n        this.parentWindow = null;\r\n        this._saveState();\r\n    }\r\n}\r\n\r\n// Export to window for global access\r\n(window as any).BaseTab = BaseTab;\r\n"]}